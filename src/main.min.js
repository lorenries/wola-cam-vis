!function(){"use strict";var e="bx";function t(e){return e.reduce(function(e,n){return Array.isArray(n)?e.push.apply(e,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t(n))):e.push(n),e},[])}function n(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return t(n).reduce(function(e,t){return t(e)},function(){return function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}}())}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function a(e){return function(t){function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t));if(r.children=[],!e||e.nodeType!==Node.ELEMENT_NODE)throw new TypeError("DOM element should be given to initialize this widget.");return r.element=e,r.options=Object.assign(Object.create(r.constructor.options),t),r.constructor.components.set(r.element,r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,e),r(n,[{key:"release",value:function(){for(var e=this.children.pop();e;e=this.children.pop())e.release();return this.constructor.components.delete(this.element),null}}],[{key:"create",value:function(e,t){return this.components.get(e)||new this(e,t)}}]),n}()}var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function o(e){return function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,e),i(n,null,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object.assign(Object.create(this.options),n);if(t.nodeType!==Node.ELEMENT_NODE&&t.nodeType!==Node.DOCUMENT_NODE)throw new TypeError("DOM document or DOM element should be given to search for and initialize this widget.");t.nodeType===Node.ELEMENT_NODE&&t.matches(r.selectorInit)?this.create(t,n):[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t.querySelectorAll(r.selectorInit))).forEach(function(t){return e.create(t,n)})}}]),n}()}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function c(e){return function(t){function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,e),s(n,[{key:"_changeState",value:function(){throw new Error("_changeState() should be overriden to perform actual change in state.")}},{key:"changeState",value:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var a="string"==typeof n[0]?n.shift():void 0,i=Object(n[0])===n[0]&&"function"!=typeof n[0]?n.shift():void 0,o="function"==typeof n[0]?n.shift():void 0;if("function"!=typeof this.shouldStateBeChanged||this.shouldStateBeChanged(a,i)){var s={group:i&&i.group,state:a},c=[s.group,a].filter(Boolean).join("-").split("-").map(function(e){return e[0].toUpperCase()+e.substr(1)}).join(""),l=new CustomEvent(this.options["eventBefore"+c],{bubbles:!0,cancelable:!0,detail:i}),u=i&&i.delegatorNode||this.element;if(!u.dispatchEvent(l)){if(o){var f=new Error("Changing state ("+JSON.stringify(s)+") has been canceled.");f.canceled=!0,o(f)}}else{var d=[a,i].filter(Boolean);this._changeState.apply(this,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(d).concat([function(){u.dispatchEvent(new CustomEvent(e.options["eventAfter"+c],{bubbles:!0,cancelable:!0,detail:i})),o&&o()}]))}}else o&&o(null,!0)}}]),n}()}function l(e,t){if("function"==typeof e.target.matches){if(e.target.matches(t))return e.target;if(e.target.matches(t+" *")){var n=e.target.closest(t);if(e.currentTarget.contains(n))return n}}}var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function f(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var d=function(t){function r(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t));return h.call(n),n.container=e.parentNode,n.toolbarEl=n.element.querySelector(n.options.selectorToolbar),n.batchActionEl=n.element.querySelector(n.options.selectorActions),n.countEl=n.element.querySelector(n.options.selectorCount),n.cancelEl=n.element.querySelector(n.options.selectorActionCancel),n.tableHeaders=n.element.querySelectorAll("th"),n.tableBody=n.element.querySelector(n.options.selectorTableBody),n.expandCells=[],n.expandableRows=[],n.parentRows=[],n.refreshRows(),n.element.addEventListener("mouseover",function(e){var t=l(e,n.options.selectorChildRow);t&&n._expandableHoverToggle(t,!0)}),n.element.addEventListener("click",function(e){var t=l(e,n.options.eventTrigger);t&&n._toggleState(t,e)}),n.element.addEventListener("keydown",n._keydownHandler),n.state={checkboxCount:0},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,n(a,o,c)),u(r,[{key:"_changeState",value:function(e,t){this[this.constructor.eventHandlers[e.group]](e),t()}}],[{key:"options",get:function(){return{selectorInit:"[data-table-v2]",selectorToolbar:"."+e+"--table--toolbar",selectorActions:"."+e+"--batch-actions",selectorCount:"[data-items-selected]",selectorActionCancel:"."+e+"--batch-summary__cancel",selectorCheckbox:"."+e+"--checkbox",selectorExpandCells:"."+e+"--table-expand-v2",selectorExpandableRows:"."+e+"--expandable-row-v2",selectorParentRows:"."+e+"--parent-row-v2",selectorChildRow:"[data-child-row]",selectorTableBody:"tbody",selectorTableSort:"."+e+"--table-sort-v2",classExpandableRow:e+"--expandable-row-v2",classExpandableRowHidden:e+"--expandable-row--hidden-v2",classExpandableRowHover:e+"--expandable-row--hover-v2",classTableSortAscending:e+"--table-sort-v2--ascending",classTableSortActive:e+"--table-sort-v2--active",classActionBarActive:e+"--batch-actions--active",classTableSelected:e+"--data-table-v2--selected",eventBeforeExpand:"data-table-v2-beforetoggleexpand",eventAfterExpand:"data-table-v2-aftertoggleexpand",eventBeforeSort:"data-table-v2-beforetogglesort",eventAfterSort:"data-table-v2-aftertogglesort",eventTrigger:"[data-event]",eventParentContainer:"[data-parent-row]"}}}]),r}();d.components=new WeakMap,d.eventHandlers={expand:"_rowExpandToggle",sort:"_sortToggle",select:"_selectToggle","select-all":"_selectAllToggle","action-bar-cancel":"_actionBarCancel"};var h=function(){var e=this;this._sortToggle=function(t){var n=t.element,r=t.previousValue;[].concat(f(e.tableHeaders)).forEach(function(t){var r=t.querySelector(e.options.selectorTableSort);null!==r&&r!==n&&(r.classList.remove(e.options.classTableSortActive),r.classList.remove(e.options.classTableSortAscending))}),r&&"descending"!==r?(n.dataset.previousValue="descending",n.classList.add(e.options.classTableSortActive),n.classList.remove(e.options.classTableSortAscending)):(n.dataset.previousValue="ascending",n.classList.add(e.options.classTableSortActive),n.classList.add(e.options.classTableSortAscending))},this._selectToggle=function(t){var n=t.element,r=n.checked;e.state.checkboxCount+=r?1:-1,e.countEl.textContent=e.state.checkboxCount,n.parentNode.parentNode.classList.toggle(e.options.classTableSelected),e._actionBarToggle(e.state.checkboxCount>0)},this._selectAllToggle=function(t){var n=t.element.checked,r=[].concat(f(e.element.querySelectorAll(e.options.selectorCheckbox)));e.state.checkboxCount=n?r.length-1:0,r.forEach(function(t){t.checked=n;var r=t.parentNode.parentNode;n&&r?r.classList.add(e.options.classTableSelected):r.classList.remove(e.options.classTableSelected)}),e._actionBarToggle(e.state.checkboxCount>0),e.countEl.textContent=e.state.checkboxCount},this._actionBarCancel=function(){[].concat(f(e.element.querySelectorAll(e.options.selectorCheckbox))).forEach(function(e){e.checked=!1}),e.state.checkboxCount=0,e._actionBarToggle(!1),e.countEl.textContent=e.state.checkboxCount},this._actionBarToggle=function(t){t?(e.batchActionEl.dataset.active=!0,e.batchActionEl.classList.add(e.options.classActionBarActive)):(e.batchActionEl.dataset.active=!1,e.batchActionEl.classList.remove(e.options.classActionBarActive)),e.batchActionEl.addEventListener("transitionend",function t(n){e.batchActionEl.removeEventListener("transitionend",t),n.target.matches(e.options.selectorActions)&&("false"===e.batchActionEl.dataset.active?e.batchActionEl.setAttribute("tabIndex",-1):e.batchActionEl.setAttribute("tabIndex",0))})},this._expandableRowsInit=function(t){t.forEach(function(t){t.classList.remove(e.options.classExpandableRowHidden),e.tableBody.removeChild(t)})},this._rowExpandToggle=function(t){var n=t.element,r=l(t.initialEvt,e.options.eventParentContainer),a=e.expandCells.indexOf(n);void 0===n.dataset.previousValue||"expanded"===n.dataset.previousValue?(n.dataset.previousValue="collapsed",r.classList.add(e.options.classExpandableRow),e.tableBody.insertBefore(e.expandableRows[a],e.parentRows[a+1])):(r.classList.remove(e.options.classExpandableRow),e.tableBody.removeChild(r.nextElementSibling),n.dataset.previousValue="expanded")},this._expandableHoverToggle=function(t){t.previousElementSibling.classList.add(e.options.classExpandableRowHover);t.addEventListener("mouseout",function n(){t.previousElementSibling.classList.remove(e.options.classExpandableRowHover),t.removeEventListener("mouseout",n)})},this._toggleState=function(t,n){var r=t.dataset,a=r.label?r.label:"",i=r.previousValue?r.previousValue:"",o=n;e.changeState({group:r.event,element:t,label:a,previousValue:i,initialEvt:o})},this._keydownHandler=function(t){27===t.which&&e._batchCancel()},this.refreshRows=function(){var t=[].concat(f(e.element.querySelectorAll(e.options.selectorExpandCells))),n=[].concat(f(e.element.querySelectorAll(e.options.selectorExpandableRows))),r=[].concat(f(e.element.querySelectorAll(e.options.selectorParentRows)));if(e.parentRows.length>0){var a=r.filter(function(t){return!e.parentRows.some(function(e){return e===t})});if(n.length>0){var i=a.map(function(e){return e.nextElementSibling}),o=[].concat(f(e.expandableRows),f(i));e._expandableRowsInit(i),e.expandableRows=o}}else n.length>0&&(e._expandableRowsInit(n),e.expandableRows=n);e.expandCells=t,e.parentRows=r}},p=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),g=function e(t,n,r){null===t&&(t=Function.prototype);var a=Object.getOwnPropertyDescriptor(t,n);if(void 0===a){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in a)return a.value;var o=a.get;return void 0!==o?o.call(r):void 0};function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e){return function(t){function n(){var e,t,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);for(var a=arguments.length,i=Array(a),o=0;o<a;o++)i[o]=arguments[o];return t=r=v(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(i))),r.handles=new Set,v(r,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,e),p(n,[{key:"manage",value:function(e){return this.handles.add(e),e}},{key:"unmanage",value:function(e){return this.handles.delete(e),e}},{key:"release",value:function(){var e=this;return this.handles.forEach(function(t){t.release(),e.handles.delete(t)}),g(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"release",this).call(this)}}]),n}()}function b(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.addEventListener.apply(e,n),{release:function(){return e.removeEventListener.apply(e,n),null}}}var y=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r._emitEvent=function(e,t){var n=new CustomEvent(""+e,{bubbles:!0,cancelable:!0,detail:t});r.element.dispatchEvent(n)},r.manage(b(r.element,"click",function(e){if(e.target.matches(r.options.selectorPageBackward)){var t={initialEvt:e,element:e.target,direction:"backward"};r._emitEvent(r.options.eventPageChange,t)}else if(e.target.matches(r.options.selectorPageForward)){var n={initialEvt:e,element:e.target,direction:"forward"};r._emitEvent(r.options.eventPageChange,n)}})),r.manage(b(r.element,"input",function(e){if(e.target.matches(r.options.selectorItemsPerPageInput)){var t={initialEvt:e,element:e.target,value:e.target.value};r._emitEvent(r.options.eventItemsPerPage,t)}else if(e.target.matches(r.options.selectorPageNumberInput)){var n={initialEvt:e,element:e.target,value:e.target.value};r._emitEvent(r.options.eventPageNumber,n)}})),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n(a,o,m)),t}();function w(e){for(var t=(e+="").split("."),n=t[0],r=t.length>1?"."+t[1]:"",a=/(\d+)(\d{3})/;a.test(n);)n=n.replace(a,"$1,$2");return n+r}y.components=new WeakMap,y.options={selectorInit:"[data-pagination]",selectorItemsPerPageInput:"[data-items-per-page]",selectorPageNumberInput:"[data-page-number-input]",selectorPageBackward:"[data-page-backward]",selectorPageForward:"[data-page-forward]",eventItemsPerPage:"itemsPerPage",eventPageNumber:"pageNumber",eventPageChange:"pageChange"};var x=d3.scaleOrdinal().domain(["Borders & Counternarcotics","Development","Justice and Rule of Law","Law Enforcement","Violence Prevention"]).range(["#404041","#00B5EF","#65BD60","#DA1A32","#F9C606"]);!function(e,t){if("function"==typeof define&&define.amd)define(["d3"],t);else if("object"==typeof module&&module.exports){var n=require("d3");module.exports=t(n)}else e.d3.tip=t(e.d3)}(window,function(e){return function(){var t=function(){return"n"},n=function(){return[0,0]},r=function(){return" "},a=f(),i=null,o=null,s=null;function c(e){var t;i="svg"===(t=(t=e).node()).tagName.toLowerCase()?t:t.ownerSVGElement,o=i.createSVGPoint(),document.body.appendChild(a)}c.show=function(){var e=Array.prototype.slice.call(arguments);e[e.length-1]instanceof SVGElement&&(s=e.pop());var a,i=r.apply(this,e),o=n.apply(this,e),f=t.apply(this,e),h=d(),p=u.length,g=document.documentElement.scrollTop||document.body.scrollTop,v=document.documentElement.scrollLeft||document.body.scrollLeft;for(h.html(i).style("opacity",1).style("pointer-events","all");p--;)h.classed(u[p],!1);return a=l.get(f).apply(this),h.classed(f,!0).style("top",a.top+o[0]+g+"px").style("left",a.left+o[1]+v+"px"),c},c.hide=function(){return d().style("opacity",0).style("pointer-events","none"),c},c.attr=function(t,n){if(arguments.length<2&&"string"==typeof t)return d().attr(t);var r=Array.prototype.slice.call(arguments);return e.selection.prototype.attr.apply(d(),r),c},c.style=function(t,n){if(arguments.length<2&&"string"==typeof t)return d().style(t);var r=Array.prototype.slice.call(arguments);return e.selection.prototype.style.apply(d(),r),c},c.direction=function(e){return arguments.length?(t=null==e?e:p(e),c):t},c.offset=function(e){return arguments.length?(n=null==e?e:p(e),c):n},c.html=function(e){return arguments.length?(r=null==e?e:p(e),c):r},c.destroy=function(){return a&&(d().remove(),a=null),c};var l=e.map({n:function(){var e=h();return{top:e.n.y-a.offsetHeight,left:e.n.x-a.offsetWidth/2}},s:function(){var e=h();return{top:e.s.y,left:e.s.x-a.offsetWidth/2}},e:function(){var e=h();return{top:e.e.y-a.offsetHeight/2,left:e.e.x}},w:function(){var e=h();return{top:e.w.y-a.offsetHeight/2,left:e.w.x-a.offsetWidth}},nw:function(){var e=h();return{top:e.nw.y-a.offsetHeight,left:e.nw.x-a.offsetWidth}},ne:function(){var e=h();return{top:e.ne.y-a.offsetHeight,left:e.ne.x}},sw:function(){var e=h();return{top:e.sw.y,left:e.sw.x-a.offsetWidth}},se:function(){var e=h();return{top:e.se.y,left:e.e.x}}}),u=l.keys();function f(){var t=e.select(document.createElement("div"));return t.style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box"),t.node()}function d(){return null===a&&(a=f(),document.body.appendChild(a)),e.select(a)}function h(){for(var t=s||e.event.target;void 0===t.getScreenCTM&&"undefined"===t.parentNode;)t=t.parentNode;var n={},r=t.getScreenCTM(),a=t.getBBox(),i=a.width,c=a.height,l=a.x,u=a.y;return o.x=l,o.y=u,n.nw=o.matrixTransform(r),o.x+=i,n.ne=o.matrixTransform(r),o.y+=c,n.se=o.matrixTransform(r),o.x-=i,n.sw=o.matrixTransform(r),o.y-=c/2,n.w=o.matrixTransform(r),o.x+=i,n.e=o.matrixTransform(r),o.x-=i/2,o.y-=c/2,n.n=o.matrixTransform(r),o.y+=c,n.s=o.matrixTransform(r),n}function p(e){return"function"==typeof e?e:function(){return e}}return c}});var _=d3.tip;var C=function(e,t){return e(t={exports:{}},t.exports),t.exports}(function(e){!function(t){e.exports?e.exports=t():window.pym=t.call(this)}(function(){var e={},t=function(e){var t=document.createEvent("Event");t.initEvent("pym:"+e,!0,!0),document.dispatchEvent(t)},n=function(e){var t=new RegExp("[\\?&]"+e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},r=function(e,t){if(("*"===t.xdomain||e.origin.match(new RegExp(t.xdomain+"$")))&&"string"==typeof e.data)return!0},a=function(e,t,n){return["pym",e,t,n].join("xPYMx")},i=Date.now||function(){return(new Date).getTime()},o=function(){for(var t=e.autoInitInstances.length-1;t>=0;t--){var n=e.autoInitInstances[t];n.el.getElementsByTagName("iframe").length&&n.el.getElementsByTagName("iframe")[0].contentWindow||e.autoInitInstances.splice(t,1)}};return e.autoInitInstances=[],e.autoInit=function(n){var r=document.querySelectorAll("[data-pym-src]:not([data-pym-auto-initialized])"),a=r.length;o();for(var i=0;i<a;++i){var s=r[i];s.setAttribute("data-pym-auto-initialized",""),""===s.id&&(s.id="pym-"+i+"-"+Math.random().toString(36).substr(2,5));var c=s.getAttribute("data-pym-src"),l={xdomain:"string",title:"string",name:"string",id:"string",sandbox:"string",allowfullscreen:"boolean",parenturlparam:"string",parenturlvalue:"string",optionalparams:"boolean",trackscroll:"boolean",scrollwait:"number"},u={};for(var f in l)if(null!==s.getAttribute("data-pym-"+f))switch(l[f]){case"boolean":u[f]=!("false"===s.getAttribute("data-pym-"+f));break;case"string":u[f]=s.getAttribute("data-pym-"+f);break;case"number":var d=Number(s.getAttribute("data-pym-"+f));isNaN(d)||(u[f]=d);break;default:console.err("unrecognized attribute type")}var h=new e.Parent(s.id,c,u);e.autoInitInstances.push(h)}return n||t("pym-initialized"),e.autoInitInstances},e.Parent=function(e,t,n){for(var s in this.id=e,this.url=t,this.el=document.getElementById(e),this.iframe=null,this.settings={xdomain:"*",optionalparams:!0,parenturlparam:"parentUrl",parenturlvalue:window.location.href,trackscroll:!1,scrollwait:100},this.messageRegex=function(e){return new RegExp("^"+["pym",e,"(\\S+)","(.*)"].join("xPYMx")+"$")}(this.id),this.messageHandlers={},n=n||{},this._constructIframe=function(){var e=this.el.offsetWidth.toString();this.iframe=document.createElement("iframe");var t="",n=this.url.indexOf("#");for(n>-1&&(t=this.url.substring(n,this.url.length),this.url=this.url.substring(0,n)),this.url.indexOf("?")<0?this.url+="?":this.url+="&",this.iframe.src=this.url+"initialWidth="+e+"&childId="+this.id,this.settings.optionalparams&&(this.iframe.src+="&parentTitle="+encodeURIComponent(document.title),this.iframe.src+="&"+this.settings.parenturlparam+"="+encodeURIComponent(this.settings.parenturlvalue)),this.iframe.src+=t,this.iframe.setAttribute("width","100%"),this.iframe.setAttribute("scrolling","no"),this.iframe.setAttribute("marginheight","0"),this.iframe.setAttribute("frameborder","0"),this.settings.title&&this.iframe.setAttribute("title",this.settings.title),void 0!==this.settings.allowfullscreen&&!1!==this.settings.allowfullscreen&&this.iframe.setAttribute("allowfullscreen",""),void 0!==this.settings.sandbox&&"string"==typeof this.settings.sandbox&&this.iframe.setAttribute("sandbox",this.settings.sandbox),this.settings.id&&(document.getElementById(this.settings.id)||this.iframe.setAttribute("id",this.settings.id)),this.settings.name&&this.iframe.setAttribute("name",this.settings.name);this.el.firstChild;)this.el.removeChild(this.el.firstChild);this.el.appendChild(this.iframe),window.addEventListener("resize",this._onResize),this.settings.trackscroll&&window.addEventListener("scroll",this._throttleOnScroll)},this._onResize=function(){this.sendWidth(),this.settings.trackscroll&&this.sendViewportAndIFramePosition()}.bind(this),this._onScroll=function(){this.sendViewportAndIFramePosition()}.bind(this),this._fire=function(e,t){if(e in this.messageHandlers)for(var n=0;n<this.messageHandlers[e].length;n++)this.messageHandlers[e][n].call(this,t)},this.remove=function(){window.removeEventListener("message",this._processMessage),window.removeEventListener("resize",this._onResize),this.el.removeChild(this.iframe),o()},this._processMessage=function(e){if(r(e,this.settings)&&"string"==typeof e.data){var t=e.data.match(this.messageRegex);if(!t||3!==t.length)return!1;var n=t[1],a=t[2];this._fire(n,a)}}.bind(this),this._onHeightMessage=function(e){var t=parseInt(e);this.iframe.setAttribute("height",t+"px")},this._onNavigateToMessage=function(e){(function(e){if(e.match(/^(?:(?:https?|mailto|ftp):|[^&:/?#]*(?:[/?#]|$))/gi))return!0})(e)&&(document.location.href=e)},this._onScrollToChildPosMessage=function(e){var t=document.getElementById(this.id).getBoundingClientRect().top+window.pageYOffset+parseInt(e);window.scrollTo(0,t)},this.onMessage=function(e,t){e in this.messageHandlers||(this.messageHandlers[e]=[]),this.messageHandlers[e].push(t)},this.sendMessage=function(e,t){this.el.getElementsByTagName("iframe").length&&(this.el.getElementsByTagName("iframe")[0].contentWindow?this.el.getElementsByTagName("iframe")[0].contentWindow.postMessage(a(this.id,e,t),"*"):this.remove())},this.sendWidth=function(){var e=this.el.offsetWidth.toString();this.sendMessage("width",e)},this.sendViewportAndIFramePosition=function(){var e=this.iframe.getBoundingClientRect(),t=(window.innerWidth||document.documentElement.clientWidth)+" "+(window.innerHeight||document.documentElement.clientHeight);t+=" "+e.top+" "+e.left,t+=" "+e.bottom+" "+e.right,this.sendMessage("viewport-iframe-position",t)},n)this.settings[s]=n[s];return this._throttleOnScroll=function(e,t,n){var r,a,o,s=null,c=0;n||(n={});var l=function(){c=!1===n.leading?0:i(),s=null,o=e.apply(r,a),s||(r=a=null)};return function(){var u=i();c||!1!==n.leading||(c=u);var f=t-(u-c);return r=this,a=arguments,f<=0||f>t?(s&&(clearTimeout(s),s=null),c=u,o=e.apply(r,a),s||(r=a=null)):s||!1===n.trailing||(s=setTimeout(l,f)),o}}(this._onScroll.bind(this),this.settings.scrollwait),this.onMessage("height",this._onHeightMessage),this.onMessage("navigateTo",this._onNavigateToMessage),this.onMessage("scrollToChildPos",this._onScrollToChildPosMessage),this.onMessage("parentPositionInfo",this.sendViewportAndIFramePosition),window.addEventListener("message",this._processMessage,!1),this._constructIframe(),this},e.Child=function(e){this.parentWidth=null,this.id=null,this.parentTitle=null,this.parentUrl=null,this.settings={renderCallback:null,xdomain:"*",polling:0,parenturlparam:"parentUrl"},this.timerId=null,this.messageRegex=null,this.messageHandlers={},e=e||{},this.onMessage=function(e,t){e in this.messageHandlers||(this.messageHandlers[e]=[]),this.messageHandlers[e].push(t)},this._fire=function(e,t){if(e in this.messageHandlers)for(var n=0;n<this.messageHandlers[e].length;n++)this.messageHandlers[e][n].call(this,t)},this._processMessage=function(e){if(r(e,this.settings)&&"string"==typeof e.data){var t=e.data.match(this.messageRegex);if(t&&3===t.length){var n=t[1],a=t[2];this._fire(n,a)}}}.bind(this),this._onWidthMessage=function(e){var t=parseInt(e);t!==this.parentWidth&&(this.parentWidth=t,this.settings.renderCallback&&this.settings.renderCallback(t),this.sendHeight())},this.sendMessage=function(e,t){window.parent.postMessage(a(this.id,e,t),"*")},this.sendHeight=function(){var e=document.getElementsByTagName("body")[0].offsetHeight.toString();return this.sendMessage("height",e),e}.bind(this),this.getParentPositionInfo=function(){this.sendMessage("parentPositionInfo")},this.scrollParentTo=function(e){this.sendMessage("navigateTo","#"+e)},this.navigateParentTo=function(e){this.sendMessage("navigateTo",e)},this.scrollParentToChildEl=function(e){var t=document.getElementById(e).getBoundingClientRect().top+window.pageYOffset;this.scrollParentToChildPos(t)},this.scrollParentToChildPos=function(e){this.sendMessage("scrollToChildPos",e.toString())};for(var i in this.remove=function(){window.removeEventListener("message",this._processMessage),this.timerId&&clearInterval(this.timerId)},e)this.settings[i]=e[i];this.id=n("childId")||e.id,this.messageRegex=new RegExp("^pymxPYMx"+this.id+"xPYMx(\\S+)xPYMx(.*)$");var o=parseInt(n("initialWidth"));return this.parentUrl=n(this.settings.parenturlparam),this.parentTitle=n("parentTitle"),this.onMessage("width",this._onWidthMessage),window.addEventListener("message",this._processMessage,!1),this.settings.renderCallback&&this.settings.renderCallback(o),this.sendHeight(),this.settings.polling&&(this.timerId=window.setInterval(this.sendHeight,this.settings.polling)),function(e){var n,r=document.getElementsByTagName("html")[0],a=r.className;try{n=window.self!==window.top?"embedded":"not-embedded"}catch(e){n="embedded"}a.indexOf(n)<0&&(r.className=a?a+" "+n:n,e&&e(n),t("marked-embedded"))}(e.onMarkedEmbeddedStatus),this},"undefined"!=typeof document&&e.autoInit(!0),e})});function M(e){var t,n=5,r=80,a=900-5-r,i=500-n-50,o=d3.select("#bar-chart").append("svg").attr("viewBox","0 0 900 500").append("g").attr("transform","translate("+r+","+n+")"),s=o.append("g").classed("bar-holder",!0),c={country:"all-countries",year:"all-years"},l=(t=new Set,e.forEach(function(e){t.add(e.year)}),Array.from(t).sort(function(e,t){return e-t}));function u(t,n){return d3.nest().key(function(e){return e.category}).entries(e).map(function(e){return{key:e.key,total:(r=e.values,"all-countries"===t&&(t=!1),"all-years"===n&&(n=!1),r.filter(function(e){return t&&!n?e.country===t:n&&!t?+e.year==+n:!t||!n||e.country===t&&+e.year==+n}).reduce(function(e,t){return e+t.total},0))};var r})}function f(e,t){var n=u(e,t),r=d3.max(u("all-countries","all-years").map(function(e){return e.total})),c=n.map(function(e){return e.key}),l=d3.scaleBand().domain(c).range([0,a]).paddingInner(.25),f=l.bandwidth(),d=d3.scaleLinear().domain([0,r]).range([i,0]),h=d3.format(".0s"),p=d3.axisBottom(l),g=d3.axisLeft(d).ticks(4).tickFormat(function(e){return"$"+h(e)});o.append("g").classed("x axis",!0).attr("transform","translate(0,"+i+")").call(p);o.append("g").classed("y axis",!0).call(g).attr("transform","translate(-15, 0)");var v=_().attr("class","d3-tip").offset([-10,0]).html(function(e){return"$"+w(e.total)});o.call(v),s.selectAll("rect.bar").data(n).transition().duration(250).attr("y",function(e){return d(e.total)}).attr("height",function(e){return i-d(e.total)}),s.selectAll("rect.bar").data(n).enter().append("rect").classed("bar",!0).attr("x",function(e,t){return l(e.key)}).attr("width",f).attr("y",function(e){return d(e.total)}).attr("height",function(e){return i-d(e.total)}).attr("fill",function(e){return x(e.key)}).attr("fill-opacity",.2).attr("stroke",function(e){return x(e.key)}).attr("stroke-width",1).on("mouseover",function(e){var t=d3.event.target,n=d3.color(x(e.key)).darker();d3.select(this).attr("stroke",n).attr("stroke-width",2),v.show(e,t)}).on("mouseout",function(e){d3.select(this).attr("stroke",x(e.key)).attr("stroke-width",1),v.hide(e)})}d3.select("#countries-toolbar").selectAll(".button").on("click",function(){d3.event.preventDefault(),d3.selectAll("#countries-toolbar .button").classed("active",!1);var e=d3.select(this);e.classed("active",!0);var t=e.attr("id");c.country=t,f(c.country,c.year)}),d3.select("#years-toolbar").selectAll(".year").data(l).enter().append("a").attr("href","#").attr("id",function(e){return e}).classed("year button",!0).text(function(e){return e}),d3.select("#years-toolbar").selectAll(".button").on("click",function(){d3.event.preventDefault(),d3.selectAll("#years-toolbar .button").classed("active",!1);var e=d3.select(this);e.classed("active",!0);var t=e.attr("id");c.year=t,f(c.country,c.year)}),f()}var A="http://www.w3.org/1999/xhtml",T={svg:"http://www.w3.org/2000/svg",xhtml:A,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function E(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),T.hasOwnProperty(t)?{space:T[t],local:e}:e}function S(e){var t=E(e);return(t.local?function(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}:function(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===A&&t.documentElement.namespaceURI===A?t.createElement(e):t.createElementNS(n,e)}})(t)}var k=function(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var N=document.documentElement;if(!N.matches){var O=N.webkitMatchesSelector||N.msMatchesSelector||N.mozMatchesSelector||N.oMatchesSelector;k=function(e){return function(){return O.call(this,e)}}}}var P=k,L={};"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(L={mouseenter:"mouseover",mouseleave:"mouseout"}));function I(e,t,n){return e=D(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function D(e,t,n){return function(r){try{e.call(this,this.__data__,t,n)}finally{}}}function H(e){return function(){var t=this.__on;if(t){for(var n,r=0,a=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++a]=n:this.removeEventListener(n.type,n.listener,n.capture);++a?t.length=a:delete this.__on}}}function B(e,t,n){var r=L.hasOwnProperty(e.type)?I:D;return function(a,i,o){var s,c=this.__on,l=r(t,i,o);if(c)for(var u=0,f=c.length;u<f;++u)if((s=c[u]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=l,s.capture=n),void(s.value=t);this.addEventListener(e.type,l,n),s={type:e.type,name:e.name,value:t,listener:l,capture:n},c?c.push(s):this.__on=[s]}}function U(){}function j(e){return null==e?U:function(){return this.querySelector(e)}}function R(){return[]}function F(e){return new Array(e.length)}function q(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}q.prototype={constructor:q,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var Y="$";function W(e,t,n,r,a,i){for(var o,s=0,c=t.length,l=i.length;s<l;++s)(o=t[s])?(o.__data__=i[s],r[s]=o):n[s]=new q(e,i[s]);for(;s<c;++s)(o=t[s])&&(a[s]=o)}function $(e,t,n,r,a,i,o){var s,c,l,u={},f=t.length,d=i.length,h=new Array(f);for(s=0;s<f;++s)(c=t[s])&&(h[s]=l=Y+o.call(c,c.__data__,s,t),l in u?a[s]=c:u[l]=c);for(s=0;s<d;++s)(c=u[l=Y+o.call(e,i[s],s,i)])?(r[s]=c,c.__data__=i[s],u[l]=null):n[s]=new q(e,i[s]);for(s=0;s<f;++s)(c=t[s])&&u[h[s]]===c&&(a[s]=c)}function z(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function V(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Z(e){return e.trim().split(/^|\s+/)}function X(e){return e.classList||new J(e)}function J(e){this._node=e,this._names=Z(e.getAttribute("class")||"")}function Q(e,t){for(var n=X(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function G(e,t){for(var n=X(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function K(){this.textContent=""}function ee(){this.innerHTML=""}function te(){this.nextSibling&&this.parentNode.appendChild(this)}function ne(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function re(){return null}function ae(){var e=this.parentNode;e&&e.removeChild(this)}function ie(e,t,n){var r=V(e),a=r.CustomEvent;a?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}J.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var oe,se=[null];function ce(e,t){this._groups=e,this._parents=t}function le(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function ue(e){return(e=le(Math.abs(e)))?e[1]:NaN}function fe(e,t){var n=le(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}ce.prototype=function(){return new ce([[document.documentElement]],se)}.prototype={constructor:ce,select:function(e){"function"!=typeof e&&(e=j(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o,s=t[a],c=s.length,l=r[a]=new Array(c),u=0;u<c;++u)(i=s[u])&&(o=e.call(i,i.__data__,u,s))&&("__data__"in i&&(o.__data__=i.__data__),l[u]=o);return new ce(r,this._parents)},selectAll:function(e){var t;"function"!=typeof e&&(e=null==(t=e)?R:function(){return this.querySelectorAll(t)});for(var n=this._groups,r=n.length,a=[],i=[],o=0;o<r;++o)for(var s,c=n[o],l=c.length,u=0;u<l;++u)(s=c[u])&&(a.push(e.call(s,s.__data__,u,c)),i.push(s));return new ce(a,i)},filter:function(e){"function"!=typeof e&&(e=P(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o=t[a],s=o.length,c=r[a]=[],l=0;l<s;++l)(i=o[l])&&e.call(i,i.__data__,l,o)&&c.push(i);return new ce(r,this._parents)},data:function(e,t){if(!e)return p=new Array(this.size()),u=-1,this.each(function(e){p[++u]=e}),p;var n,r=t?$:W,a=this._parents,i=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var o=i.length,s=new Array(o),c=new Array(o),l=new Array(o),u=0;u<o;++u){var f=a[u],d=i[u],h=d.length,p=e.call(f,f&&f.__data__,u,a),g=p.length,v=c[u]=new Array(g),m=s[u]=new Array(g);r(f,d,v,m,l[u]=new Array(h),p,t);for(var b,y,w=0,x=0;w<g;++w)if(b=v[w]){for(w>=x&&(x=w+1);!(y=m[x])&&++x<g;);b._next=y||null}}return(s=new ce(s,a))._enter=c,s._exit=l,s},enter:function(){return new ce(this._enter||this._groups.map(F),this._parents)},exit:function(){return new ce(this._exit||this._groups.map(F),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,a=n.length,i=Math.min(r,a),o=new Array(r),s=0;s<i;++s)for(var c,l=t[s],u=n[s],f=l.length,d=o[s]=new Array(f),h=0;h<f;++h)(c=l[h]||u[h])&&(d[h]=c);for(;s<r;++s)o[s]=t[s];return new ce(o,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,a=e[t],i=a.length-1,o=a[i];--i>=0;)(r=a[i])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=z);for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var o,s=n[i],c=s.length,l=a[i]=new Array(c),u=0;u<c;++u)(o=s[u])&&(l[u]=o);l.sort(t)}return new ce(a,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,i=r.length;a<i;++a){var o=r[a];if(o)return o}return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a,i=t[n],o=0,s=i.length;o<s;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this},attr:function(e,t){var n=E(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}}:"function"==typeof t?n.local?function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}:function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}:n.local?function(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}:function(e,t){return function(){this.setAttribute(e,t)}})(n,t))},style:function(e,t,n){var r;return arguments.length>1?this.each((null==t?function(e){return function(){this.style.removeProperty(e)}}:"function"==typeof t?function(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}:function(e,t,n){return function(){this.style.setProperty(e,t,n)}})(e,t,null==n?"":n)):V(r=this.node()).getComputedStyle(r,null).getPropertyValue(e)},property:function(e,t){return arguments.length>1?this.each((null==t?function(e){return function(){delete this[e]}}:"function"==typeof t?function(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}:function(e,t){return function(){this[e]=t}})(e,t)):this.node()[e]},classed:function(e,t){var n=Z(e+"");if(arguments.length<2){for(var r=X(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"==typeof t?function(e,t){return function(){(t.apply(this,arguments)?Q:G)(this,e)}}:t?function(e){return function(){Q(this,e)}}:function(e){return function(){G(this,e)}})(n,t))},text:function(e){return arguments.length?this.each(null==e?K:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(e){return function(){this.textContent=e}})(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?ee:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(e){return function(){this.innerHTML=e}})(e)):this.node().innerHTML},raise:function(){return this.each(te)},lower:function(){return this.each(ne)},append:function(e){var t="function"==typeof e?e:S(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:S(e),r=null==t?re:"function"==typeof t?t:j(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(ae)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,a,i=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),o=i.length;if(!(arguments.length<2)){for(s=t?B:H,null==n&&(n=!1),r=0;r<o;++r)this.each(s(i[r],t,n));return this}var s=this.node().__on;if(s)for(var c,l=0,u=s.length;l<u;++l)for(r=0,c=s[l];r<o;++r)if((a=i[r]).type===c.type&&a.name===c.name)return c.value},dispatch:function(e,t){return this.each(("function"==typeof t?function(e,t){return function(){return ie(this,e,t.apply(this,arguments))}}:function(e,t){return function(){return ie(this,e,t)}})(e,t))}};var de={"":function(e,t){e=e.toPrecision(t);e:for(var n,r=e.length,a=1,i=-1;a<r;++a)switch(e[a]){case".":i=n=a;break;case"0":0===i&&(i=a),n=a;break;case"e":break e;default:i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(n+1):e},"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return fe(100*e,t)},r:fe,s:function(e,t){var n=le(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(oe=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+le(e,Math.max(0,t+i-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},he=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;function pe(e){return new ge(e)}function ge(e){if(!(t=he.exec(e)))throw new Error("invalid format: "+e);var t,n=t[1]||" ",r=t[2]||">",a=t[3]||"-",i=t[4]||"",o=!!t[5],s=t[6]&&+t[6],c=!!t[7],l=t[8]&&+t[8].slice(1),u=t[9]||"";"n"===u?(c=!0,u="g"):de[u]||(u=""),(o||"0"===n&&"="===r)&&(o=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=a,this.symbol=i,this.zero=o,this.width=s,this.comma=c,this.precision=l,this.type=u}ge.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var ve,me,be,ye=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function we(e){return e}function xe(e){var t,n,r=e.grouping&&e.thousands?(t=e.grouping,n=e.thousands,function(e,r){for(var a=e.length,i=[],o=0,s=t[0],c=0;a>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),i.push(e.substring(a-=s,a+s)),!((c+=s+1)>r));)s=t[o=(o+1)%t.length];return i.reverse().join(n)}):we,a=e.currency,i=e.decimal;function o(e){var t=(e=pe(e)).fill,n=e.align,o=e.sign,s=e.symbol,c=e.zero,l=e.width,u=e.comma,f=e.precision,d=e.type,h="$"===s?a[0]:"#"===s&&/[boxX]/.test(d)?"0"+d.toLowerCase():"",p="$"===s?a[1]:/[%p]/.test(d)?"%":"",g=de[d],v=!d||/[defgprs%]/.test(d);function m(e){var a,s,m,b=h,y=p;if("c"===d)y=g(e)+y,e="";else{var w=((e=+e)<0||1/e<0)&&(e*=-1,!0);if(e=g(e,f),w)for(a=-1,s=e.length,w=!1;++a<s;)if(48<(m=e.charCodeAt(a))&&m<58||"x"===d&&96<m&&m<103||"X"===d&&64<m&&m<71){w=!0;break}if(b=(w?"("===o?o:"-":"-"===o||"("===o?"":o)+b,y=y+("s"===d?ye[8+oe/3]:"")+(w&&"("===o?")":""),v)for(a=-1,s=e.length;++a<s;)if(48>(m=e.charCodeAt(a))||m>57){y=(46===m?i+e.slice(a+1):e.slice(a))+y,e=e.slice(0,a);break}}u&&!c&&(e=r(e,1/0));var x=b.length+e.length+y.length,_=x<l?new Array(l-x+1).join(t):"";switch(u&&c&&(e=r(_+e,_.length?l-y.length:1/0),_=""),n){case"<":return b+e+y+_;case"=":return b+_+e+y;case"^":return _.slice(0,x=_.length>>1)+b+e+y+_.slice(x)}return _+b+e+y}return f=null==f?d?6:12:/[gprs]/.test(d)?Math.max(1,Math.min(21,f)):Math.max(0,Math.min(20,f)),m.toString=function(){return e+""},m}return{format:o,formatPrefix:function(e,t){var n=o(((e=pe(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(ue(t)/3))),a=Math.pow(10,-r),i=ye[8+r/3];return function(e){return n(a*e)+i}}}}ve=xe({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),me=ve.format,be=ve.formatPrefix;var _e={value:function(){}};function Ce(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r)throw new Error("illegal type: "+e);r[e]=[]}return new Me(r)}function Me(e){this._=e}function Ae(e,t){for(var n,r=0,a=e.length;r<a;++r)if((n=e[r]).name===t)return n.value}function Te(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=_e,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}function Ee(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}Me.prototype=Ce.prototype={constructor:Me,on:function(e,t){var n,r,a=this._,i=(r=a,(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}})),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++o<s;)if(n=(e=i[o]).type)a[n]=Te(a[n],e.name,t);else if(null==t)for(n in a)a[n]=Te(a[n],e.name,null);return this}for(;++o<s;)if((n=(e=i[o]).type)&&(n=Ae(a[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Me(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),i=0;i<n;++i)a[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,a)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,i=r.length;a<i;++a)r[a].value.apply(t,n)}};var Se,ke,Ne=(1===(Se=Ee).length&&(ke=Se,Se=function(e,t){return Ee(ke(e),t)}),{left:function(e,t,n,r){for(null==n&&(n=0),null==r&&(r=e.length);n<r;){var a=n+r>>>1;Se(e[a],t)<0?n=a+1:r=a}return n},right:function(e,t,n,r){for(null==n&&(n=0),null==r&&(r=e.length);n<r;){var a=n+r>>>1;Se(e[a],t)>0?r=a:n=a+1}return n}}).right;var Oe=Math.sqrt(50),Pe=Math.sqrt(10),Le=Math.sqrt(2);function Ie(e,t,n){var r=De(e,t,n);return function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}(Math.ceil(e/r)*r,Math.floor(t/r)*r+r/2,r)}function De(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/a;return i>=Oe?a*=10:i>=Pe?a*=5:i>=Le&&(a*=2),t<e?-a:a}function He(){}function Be(e,t){var n=new He;if(e instanceof He)e.each(function(e,t){n.set(t,e)});else if(Array.isArray(e)){var r,a=-1,i=e.length;if(null==t)for(;++a<i;)n.set(a,e[a]);else for(;++a<i;)n.set(t(r=e[a],a,e),r)}else if(e)for(var o in e)n.set(o,e[o]);return n}function Ue(){}He.prototype=Be.prototype={constructor:He,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if("$"===e[0])return!1;return!0},each:function(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var je=Be.prototype;Ue.prototype=function(e,t){var n=new Ue;if(e instanceof Ue)e.each(function(e){n.add(e)});else if(e){var r=-1,a=e.length;if(null==t)for(;++r<a;)n.add(e[r]);else for(;++r<a;)n.add(t(e[r],r,e))}return n}.prototype={constructor:Ue,has:je.has,add:function(e){return this["$"+(e+="")]=e,this},remove:je.remove,clear:je.clear,values:je.keys,size:je.size,empty:je.empty,each:je.each};var Re=Array.prototype,Fe=Re.map,qe=Re.slice;function Ye(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function We(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function $e(){}var ze="\\s*([+-]?\\d+)\\s*",Ve="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ze="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xe=/^#([0-9a-f]{3})$/,Je=/^#([0-9a-f]{6})$/,Qe=new RegExp("^rgb\\("+[ze,ze,ze]+"\\)$"),Ge=new RegExp("^rgb\\("+[Ze,Ze,Ze]+"\\)$"),Ke=new RegExp("^rgba\\("+[ze,ze,ze,Ve]+"\\)$"),et=new RegExp("^rgba\\("+[Ze,Ze,Ze,Ve]+"\\)$"),tt=new RegExp("^hsl\\("+[Ve,Ze,Ze]+"\\)$"),nt=new RegExp("^hsla\\("+[Ve,Ze,Ze,Ve]+"\\)$"),rt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function at(e){var t;return e=(e+"").trim().toLowerCase(),(t=Xe.exec(e))?new lt((t=parseInt(t[1],16))>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):(t=Je.exec(e))?it(parseInt(t[1],16)):(t=Qe.exec(e))?new lt(t[1],t[2],t[3],1):(t=Ge.exec(e))?new lt(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Ke.exec(e))?ot(t[1],t[2],t[3],t[4]):(t=et.exec(e))?ot(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=tt.exec(e))?ut(t[1],t[2]/100,t[3]/100,1):(t=nt.exec(e))?ut(t[1],t[2]/100,t[3]/100,t[4]):rt.hasOwnProperty(e)?it(rt[e]):"transparent"===e?new lt(NaN,NaN,NaN,0):null}function it(e){return new lt(e>>16&255,e>>8&255,255&e,1)}function ot(e,t,n,r){return r<=0&&(e=t=n=NaN),new lt(e,t,n,r)}function st(e){return e instanceof $e||(e=at(e)),e?new lt((e=e.rgb()).r,e.g,e.b,e.opacity):new lt}function ct(e,t,n,r){return 1===arguments.length?st(e):new lt(e,t,n,null==r?1:r)}function lt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function ut(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ft(e,t,n,r)}function ft(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function dt(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}Ye($e,at,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),Ye(lt,ct,We($e,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new lt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new lt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}})),Ye(ft,function(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof ft)return new ft(e.h,e.s,e.l,e.opacity);if(e instanceof $e||(e=at(e)),!e)return new ft;if(e instanceof ft)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,s=i-a,c=(i+a)/2;return s?(o=t===i?(n-r)/s+6*(n<r):n===i?(r-t)/s+2:(t-n)/s+4,s/=c<.5?i+a:2-i-a,o*=60):s=c>0&&c<1?0:o,new ft(o,s,c,e.opacity)}(e):new ft(e,t,n,null==r?1:r)},We($e,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new ft(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new ft(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new lt(dt(e>=240?e-240:e+120,a,r),dt(e,a,r),dt(e<120?e+240:e-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var ht=Math.PI/180,pt=180/Math.PI,gt=.95047,vt=1,mt=1.08883,bt=4/29,yt=6/29,wt=3*yt*yt,xt=yt*yt*yt;function _t(e){if(e instanceof Ct)return new Ct(e.l,e.a,e.b,e.opacity);if(e instanceof St){var t=e.h*ht;return new Ct(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof lt||(e=st(e));var n=Et(e.r),r=Et(e.g),a=Et(e.b),i=Mt((.4124564*n+.3575761*r+.1804375*a)/gt),o=Mt((.2126729*n+.7151522*r+.072175*a)/vt);return new Ct(116*o-16,500*(i-o),200*(o-Mt((.0193339*n+.119192*r+.9503041*a)/mt)),e.opacity)}function Ct(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function Mt(e){return e>xt?Math.pow(e,1/3):e/wt+bt}function At(e){return e>yt?e*e*e:wt*(e-bt)}function Tt(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Et(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function St(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}Ye(Ct,function(e,t,n,r){return 1===arguments.length?_t(e):new Ct(e,t,n,null==r?1:r)},We($e,{brighter:function(e){return new Ct(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Ct(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return e=vt*At(e),new lt(Tt(3.2404542*(t=gt*At(t))-1.5371385*e-.4985314*(n=mt*At(n))),Tt(-.969266*t+1.8760108*e+.041556*n),Tt(.0556434*t-.2040259*e+1.0572252*n),this.opacity)}})),Ye(St,function(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof St)return new St(e.h,e.c,e.l,e.opacity);e instanceof Ct||(e=_t(e));var t=Math.atan2(e.b,e.a)*pt;return new St(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}(e):new St(e,t,n,null==r?1:r)},We($e,{brighter:function(e){return new St(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new St(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return _t(this).rgb()}}));var kt=-.14861,Nt=1.78277,Ot=-.29227,Pt=-.90649,Lt=1.97294,It=Lt*Pt,Dt=Lt*Nt,Ht=Nt*Ot-Pt*kt;function Bt(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof Ut)return new Ut(e.h,e.s,e.l,e.opacity);e instanceof lt||(e=st(e));var t=e.r/255,n=e.g/255,r=e.b/255,a=(Ht*r+It*t-Dt*n)/(Ht+It-Dt),i=r-a,o=(Lt*(n-a)-Ot*i)/Pt,s=Math.sqrt(o*o+i*i)/(Lt*a*(1-a)),c=s?Math.atan2(o,i)*pt-120:NaN;return new Ut(c<0?c+360:c,s,a,e.opacity)}(e):new Ut(e,t,n,null==r?1:r)}function Ut(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function jt(e){return function(){return e}}function Rt(e,t){return function(n){return e+n*t}}function Ft(e){return 1==(e=+e)?qt:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):jt(isNaN(t)?n:t)}}function qt(e,t){var n=t-e;return n?Rt(e,n):jt(isNaN(e)?t:e)}Ye(Ut,Bt,We($e,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Ut(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Ut(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*ht,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),a=Math.sin(e);return new lt(255*(t+n*(kt*r+Nt*a)),255*(t+n*(Ot*r+Pt*a)),255*(t+n*(Lt*r)),this.opacity)}}));var Yt=function e(t){var n=Ft(t);function r(e,t){var r=n((e=ct(e)).r,(t=ct(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),o=qt(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function Wt(e,t){return t-=e=+e,function(n){return e+t*n}}var $t=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zt=new RegExp($t.source,"g");function Vt(e,t){var n,r=typeof t;return null==t||"boolean"===r?jt(t):("number"===r?Wt:"string"===r?(n=at(t))?(t=n,Yt):function(e,t){var n,r,a,i=$t.lastIndex=zt.lastIndex=0,o=-1,s=[],c=[];for(e+="",t+="";(n=$t.exec(e))&&(r=zt.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:Wt(n,r)})),i=zt.lastIndex;return i<t.length&&(a=t.slice(i),s[o]?s[o]+=a:s[++o]=a),s.length<2?c[0]?function(e){return function(t){return e(t)+""}}(c[0].x):function(e){return function(){return e}}(t):(t=c.length,function(e){for(var n,r=0;r<t;++r)s[(n=c[r]).i]=n.x(e);return s.join("")})}:t instanceof at?Yt:t instanceof Date?function(e,t){var n=new Date;return t-=e=+e,function(r){return n.setTime(e+t*r),n}}:Array.isArray(t)?function(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=Vt(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?function(e,t){var n,r={},a={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=Vt(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}:Wt)(e,t)}function Zt(e,t){return t-=e=+e,function(n){return Math.round(e+t*n)}}Math.PI,Math.SQRT2;function Xt(e){return function t(n){function r(t,r){var a=e((t=Bt(t)).h,(r=Bt(r)).h),i=qt(t.s,r.s),o=qt(t.l,r.l),s=qt(t.opacity,r.opacity);return function(e){return t.h=a(e),t.s=i(e),t.l=o(Math.pow(e,n)),t.opacity=s(e),t+""}}return n=+n,r.gamma=t,r}(1)}Xt(function(e,t){var n=t-e;return n?Rt(e,n>180||n<-180?n-360*Math.round(n/360):n):jt(isNaN(e)?t:e)});var Jt=Xt(qt);function Qt(e){return+e}var Gt=[0,1];function Kt(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=t,function(){return n});var n}function en(e,t,n,r){var a=e[0],i=e[1],o=t[0],s=t[1];return i<a?(a=n(i,a),o=r(s,o)):(a=n(a,i),o=r(o,s)),function(e){return o(a(e))}}function tn(e,t,n,r){var a=Math.min(e.length,t.length)-1,i=new Array(a),o=new Array(a),s=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<a;)i[s]=n(e[s],e[s+1]),o[s]=r(t[s],t[s+1]);return function(t){var n=Ne(e,t,1,a)-1;return o[n](i[n](t))}}function nn(e,t,n){var r,a=e[0],i=e[e.length-1],o=De(a,i,null==t?10:t);switch((n=pe(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(a),Math.abs(i));return null!=n.precision||isNaN(r=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ue(t)/3)))-ue(Math.abs(e)))}(o,s))||(n.precision=r),be(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ue(t)-ue(e))+1}(o,Math.max(Math.abs(a),Math.abs(i))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=function(e){return Math.max(0,-ue(Math.abs(e)))}(o))||(n.precision=r-2*("%"===n.type))}return me(n)}function rn(){var e=function(e,t){var n,r,a,i=Gt,o=Gt,s=Vt,c=!1;function l(){return n=Math.min(i.length,o.length)>2?tn:en,r=a=null,u}function u(t){return(r||(r=n(i,o,c?function(e){return function(t,n){var r=e(t=+t,n=+n);return function(e){return e<=t?0:e>=n?1:r(e)}}}(e):e,s)))(+t)}return u.invert=function(e){return(a||(a=n(o,i,Kt,c?function(e){return function(t,n){var r=e(t=+t,n=+n);return function(e){return e<=0?t:e>=1?n:r(e)}}}(t):t)))(+e)},u.domain=function(e){return arguments.length?(i=Fe.call(e,Qt),l()):i.slice()},u.range=function(e){return arguments.length?(o=qe.call(e),l()):o.slice()},u.rangeRound=function(e){return o=qe.call(e),s=Zt,l()},u.clamp=function(e){return arguments.length?(c=!!e,l()):c},u.interpolate=function(e){return arguments.length?(s=e,l()):s},l()}(Kt,Wt);return e.copy=function(){return t=e,rn().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp());var t},function(e){var t=e.domain;return e.ticks=function(e){var n=t();return Ie(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){return nn(t(),e,n)},e.nice=function(n){var r=t(),a=r.length-1,i=null==n?10:n,o=r[0],s=r[a],c=De(o,s,i);return c&&(c=De(Math.floor(o/c)*c,Math.ceil(s/c)*c,i),r[0]=Math.floor(o/c)*c,r[a]=Math.ceil(s/c)*c,t(r)),e},e}(e)}var an=new Date,on=new Date;function sn(e,t,n,r){function a(t){return e(t=new Date(+t)),t}return a.floor=a,a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,s=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r&&i>0))return s;do{s.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return s},a.filter=function(n){return sn(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})},n&&(a.count=function(t,r){return an.setTime(+t),on.setTime(+r),e(an),e(on),Math.floor(n(an,on))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e==0}:function(t){return a.count(0,t)%e==0}):a:null}),a}var cn=sn(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});cn.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?sn(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):cn:null};var ln=6e4,un=6048e5,fn=(sn(function(e){e.setTime(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),sn(function(e){e.setTime(Math.floor(e/ln)*ln)},function(e,t){e.setTime(+e+t*ln)},function(e,t){return(t-e)/ln},function(e){return e.getMinutes()}),sn(function(e){var t=e.getTimezoneOffset()*ln%36e5;t<0&&(t+=36e5),e.setTime(36e5*Math.floor((+e-t)/36e5)+t)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()}),sn(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ln)/864e5},function(e){return e.getDate()-1}));function dn(e){return sn(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ln)/un})}var hn=dn(0),pn=dn(1),gn=(dn(2),dn(3),dn(4)),vn=(dn(5),dn(6),sn(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),sn(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}));vn.every=function(e){return isFinite(e=Math.floor(e))&&e>0?sn(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};sn(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*ln)},function(e,t){return(t-e)/ln},function(e){return e.getUTCMinutes()}),sn(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()});var mn=sn(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1});function bn(e){return sn(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/un})}var yn=bn(0),wn=bn(1),xn=(bn(2),bn(3),bn(4)),_n=(bn(5),bn(6),sn(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),sn(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}));function Cn(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Mn(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function An(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}_n.every=function(e){return isFinite(e=Math.floor(e))&&e>0?sn(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var Tn,En,Sn,kn={"-":"",_:" ",0:"0"},Nn=/^\s*\d+/,On=/^%/,Pn=/[\\^$*+?|[\]().{}]/g;function Ln(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function In(e){return e.replace(Pn,"\\$&")}function Dn(e){return new RegExp("^(?:"+e.map(In).join("|")+")","i")}function Hn(e){for(var t={},n=-1,r=e.length;++n<r;)t[e[n].toLowerCase()]=n;return t}function Bn(e,t,n){var r=Nn.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Un(e,t,n){var r=Nn.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function jn(e,t,n){var r=Nn.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Rn(e,t,n){var r=Nn.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Fn(e,t,n){var r=Nn.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function qn(e,t,n){var r=Nn.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Yn(e,t,n){var r=Nn.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Wn(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function $n(e,t,n){var r=Nn.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function zn(e,t,n){var r=Nn.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Vn(e,t,n){var r=Nn.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Zn(e,t,n){var r=Nn.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Xn(e,t,n){var r=Nn.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Jn(e,t,n){var r=Nn.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Qn(e,t,n){var r=Nn.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Gn(e,t,n){var r=Nn.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Kn(e,t,n){var r=On.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function er(e,t,n){var r=Nn.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function tr(e,t,n){var r=Nn.exec(t.slice(n));return r?(e.Q=1e3*+r[0],n+r[0].length):-1}function nr(e,t){return Ln(e.getDate(),t,2)}function rr(e,t){return Ln(e.getHours(),t,2)}function ar(e,t){return Ln(e.getHours()%12||12,t,2)}function ir(e,t){return Ln(1+fn.count(vn(e),e),t,3)}function or(e,t){return Ln(e.getMilliseconds(),t,3)}function sr(e,t){return or(e,t)+"000"}function cr(e,t){return Ln(e.getMonth()+1,t,2)}function lr(e,t){return Ln(e.getMinutes(),t,2)}function ur(e,t){return Ln(e.getSeconds(),t,2)}function fr(e){var t=e.getDay();return 0===t?7:t}function dr(e,t){return Ln(hn.count(vn(e),e),t,2)}function hr(e,t){var n=e.getDay();return e=n>=4||0===n?gn(e):gn.ceil(e),Ln(gn.count(vn(e),e)+(4===vn(e).getDay()),t,2)}function pr(e){return e.getDay()}function gr(e,t){return Ln(pn.count(vn(e),e),t,2)}function vr(e,t){return Ln(e.getFullYear()%100,t,2)}function mr(e,t){return Ln(e.getFullYear()%1e4,t,4)}function br(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ln(t/60|0,"0",2)+Ln(t%60,"0",2)}function yr(e,t){return Ln(e.getUTCDate(),t,2)}function wr(e,t){return Ln(e.getUTCHours(),t,2)}function xr(e,t){return Ln(e.getUTCHours()%12||12,t,2)}function _r(e,t){return Ln(1+mn.count(_n(e),e),t,3)}function Cr(e,t){return Ln(e.getUTCMilliseconds(),t,3)}function Mr(e,t){return Cr(e,t)+"000"}function Ar(e,t){return Ln(e.getUTCMonth()+1,t,2)}function Tr(e,t){return Ln(e.getUTCMinutes(),t,2)}function Er(e,t){return Ln(e.getUTCSeconds(),t,2)}function Sr(e){var t=e.getUTCDay();return 0===t?7:t}function kr(e,t){return Ln(yn.count(_n(e),e),t,2)}function Nr(e,t){var n=e.getUTCDay();return e=n>=4||0===n?xn(e):xn.ceil(e),Ln(xn.count(_n(e),e)+(4===_n(e).getUTCDay()),t,2)}function Or(e){return e.getUTCDay()}function Pr(e,t){return Ln(wn.count(_n(e),e),t,2)}function Lr(e,t){return Ln(e.getUTCFullYear()%100,t,2)}function Ir(e,t){return Ln(e.getUTCFullYear()%1e4,t,4)}function Dr(){return"+0000"}function Hr(){return"%"}function Br(e){return+e}function Ur(e){return Math.floor(+e/1e3)}!function(e){Tn=function(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,o=e.shortDays,s=e.months,c=e.shortMonths,l=Dn(a),u=Hn(a),f=Dn(i),d=Hn(i),h=Dn(o),p=Hn(o),g=Dn(s),v=Hn(s),m=Dn(c),b=Hn(c),y={a:function(e){return o[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return c[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:nr,e:nr,f:sr,H:rr,I:ar,j:ir,L:or,m:cr,M:lr,p:function(e){return a[+(e.getHours()>=12)]},Q:Br,s:Ur,S:ur,u:fr,U:dr,V:hr,w:pr,W:gr,x:null,X:null,y:vr,Y:mr,Z:br,"%":Hr},w={a:function(e){return o[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return c[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:yr,e:yr,f:Mr,H:wr,I:xr,j:_r,L:Cr,m:Ar,M:Tr,p:function(e){return a[+(e.getUTCHours()>=12)]},Q:Br,s:Ur,S:Er,u:Sr,U:kr,V:Nr,w:Or,W:Pr,x:null,X:null,y:Lr,Y:Ir,Z:Dr,"%":Hr},x={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d[r[0].toLowerCase()],n+r[0].length):-1},b:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=b[r[0].toLowerCase()],n+r[0].length):-1},B:function(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=v[r[0].toLowerCase()],n+r[0].length):-1},c:function(e,n,r){return M(e,t,n,r)},d:zn,e:zn,f:Gn,H:Zn,I:Zn,j:Vn,L:Qn,m:$n,M:Xn,p:function(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=u[r[0].toLowerCase()],n+r[0].length):-1},Q:er,s:tr,S:Jn,u:Un,U:jn,V:Rn,w:Bn,W:Fn,x:function(e,t,r){return M(e,n,t,r)},X:function(e,t,n){return M(e,r,t,n)},y:Yn,Y:qn,Z:Wn,"%":Kn};function _(e,t){return function(n){var r,a,i,o=[],s=-1,c=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(o.push(e.slice(c,s)),null!=(a=kn[r=e.charAt(++s)])?r=e.charAt(++s):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),c=s+1);return o.push(e.slice(c,s)),o.join("")}}function C(e,t){return function(n){var r,a,i=An(1900);if(M(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("p"in i&&(i.H=i.H%12+12*i.p),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(r=(a=(r=Mn(An(i.y))).getUTCDay())>4||0===a?wn.ceil(r):wn(r),r=mn.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(r=(a=(r=t(An(i.y))).getDay())>4||0===a?pn.ceil(r):pn(r),r=fn.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?Mn(An(i.y)).getUTCDay():t(An(i.y)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,Mn(i)):t(i)}}function M(e,t,n,r){for(var a,i,o=0,s=t.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=x[a in kn?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return y.x=_(n,y),y.X=_(r,y),y.c=_(t,y),w.x=_(n,w),w.X=_(r,w),w.c=_(t,w),{format:function(e){var t=_(e+="",y);return t.toString=function(){return e},t},parse:function(e){var t=C(e+="",Cn);return t.toString=function(){return e},t},utcFormat:function(e){var t=_(e+="",w);return t.toString=function(){return e},t},utcParse:function(e){var t=C(e,Mn);return t.toString=function(){return e},t}}}(e),Tn.format,Tn.parse,En=Tn.utcFormat,Sn=Tn.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Date.prototype.toISOString||En("%Y-%m-%dT%H:%M:%S.%LZ");+new Date("2000-01-01T00:00:00.000Z")||Sn("%Y-%m-%dT%H:%M:%S.%LZ");function jr(e){return e.match(/.{6}/g).map(function(e){return"#"+e})}jr("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),jr("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),jr("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),jr("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),Jt(Bt(300,.5,0),Bt(-240,.5,1));Jt(Bt(-100,.75,.35),Bt(80,1.5,.8)),Jt(Bt(260,.75,.35),Bt(80,1.5,.8)),Bt();function Rr(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}Rr(jr("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));Rr(jr("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Rr(jr("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Rr(jr("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));var Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qr=function(e){return e},Yr=function(e){for(var t=[],n=0,r=e.length;n<r;n++)t[n]=e[r-n-1];return t},Wr=function(e,t){e.each(function(){for(var e,n,r="string"==typeof(n=this)?new ce([[document.querySelector(n)]],[document.documentElement]):new ce([[n]],se),a=r.text().split(/\s+/).reverse(),i=[],o=(r.attr("y"),parseFloat(r.attr("dy"))||0),s=r.text(null).append("tspan").attr("x",0).attr("dy",o+"em");e=a.pop();)i.push(e),s.text(i.join(" ")),s.node().getComputedTextLength()>t&&i.length>1&&(i.pop(),s.text(i.join(" ")),i=[e],s=r.append("tspan").attr("x",0).attr("dy",1.2+o+"em").text(e))})},$r={d3_drawShapes:function(e,t,n,r,a,i){"rect"===e?t.attr("height",n).attr("width",r):"circle"===e?t.attr("r",a):"line"===e?t.attr("x1",0).attr("x2",r).attr("y1",0).attr("y2",0):"path"===e&&t.attr("d",i)},d3_addText:function(e,t,n,r,a){t.append("text").attr("class",r+"label");var i=e.selectAll("g."+r+"cell text."+r+"label").data(n).text(qr);return a&&e.selectAll("g."+r+"cell text."+r+"label").call(Wr,a),i},d3_calcType:function(e,t,n,r,a,i){var o=e.invertExtent?function(e,t,n){var r=e.range().map(function(r){var a=e.invertExtent(r);return t(a[0])+" "+n+" "+t(a[1])});return{data:e.range(),labels:r,feature:qr}}(e,a,i):e.ticks?function(e,t,n){var r=[];if(t.length>1)r=t;else for(var a=e.domain(),i=(a[a.length-1]-a[0])/(t-1),o=0;o<t;o++)r.push(a[0]+o*i);return{data:r,labels:r.map(n),feature:function(t){return e(t)}}}(e,n,a):function(e){return{data:e.domain(),labels:e.domain(),feature:function(t){return e(t)}}}(e),s=e.range&&e.range()||e.domain();return o.labels=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=arguments[2],r=arguments[3],a=arguments[4];if("object"===(void 0===t?"undefined":Fr(t))){if(0===t.length)return e;for(var i=t.length;i<e.length;i++)t.push(e[i]);return t}if("function"==typeof t){for(var o=[],s=e.length,c=0;c<s;c++)o.push(t({i:c,genLength:s,generatedLabels:e,domain:n,range:r,labelDelimiter:a}));return o}return e}(o.labels,r,e.domain(),s,i),t&&(o.labels=Yr(o.labels),o.data=Yr(o.data)),o},d3_filterCells:function(e,t){var n=e.data.map(function(t,n){return{data:t,label:e.labels[n]}}).filter(t),r=n.map(function(e){return e.data}),a=n.map(function(e){return e.label});return e.data=e.data.filter(function(e){return-1!==r.indexOf(e)}),e.labels=e.labels.filter(function(e){return-1!==a.indexOf(e)}),e},d3_placement:function(e,t,n,r,a,i){t.attr("transform",n),r.attr("transform",a),"horizontal"===e&&r.style("text-anchor",i)},d3_addEvents:function(e,t){e.on("mouseover.legend",function(e){!function(e,t,n){e.call("cellover",n,t)}(t,e,this)}).on("mouseout.legend",function(e){!function(e,t,n){e.call("cellout",n,t)}(t,e,this)}).on("click.legend",function(e){!function(e,t,n){e.call("cellclick",n,t)}(t,e,this)})},d3_title:function(e,t,n,r){if(""!==t){e.selectAll("text."+n+"legendTitle").data([t]).enter().append("text").attr("class",n+"legendTitle"),e.selectAll("text."+n+"legendTitle").text(t),r&&e.selectAll("text."+n+"legendTitle").call(Wr,r);var a=e.select("."+n+"legendCells"),i=e.select("."+n+"legendTitle").nodes().map(function(e){return e.getBBox().height})[0],o=-a.nodes().map(function(e){return e.getBBox().x})[0];a.attr("transform","translate("+o+","+i+")")}},d3_defaultLocale:{format:me,formatPrefix:be},d3_defaultFormatSpecifier:".01f",d3_defaultDelimiter:"to"};var zr,Vr,Zr=function(){var e,t,n=1500,r=700,a=_().attr("class","d3-tip").offset([-10,0]).html(function(e){return function(e){return'\n      <div class="pa1 lh-title">\n        <div class=""><span class="name b">Program: </span><span class="value">'+e.name+'</span></div>\n        <div class=""><span class="name b">Total: </span><span class="value">$'+w(e.value)+'</span></div>\n        <div class=""><span class="name b">Year: </span><span class="value">'+e.year+"</span></div>\n      </div>\n    "}(e)}),i={x:n/2,y:r/2-100},o={Guatemala:{x:n/6,y:r/2},Honduras:{x:n/2,y:r/2},ElSalvador:{x:5*n/6,y:r/2}},s=d3.select("#vis").append("svg").attr("viewBox","0 0 "+n+" "+r),c=null,l=[],u={display:null,year:null},f=.06*r,d=d3.forceSimulation().velocityDecay(.6).force("x",d3.forceX(function(e){return o[e.country].x}).strength(.4)).force("y-center",d3.forceY(i.y).strength(.1)).force("y",d3.forceY(function(e){return d3.scaleLinear().domain([1,5]).range([200,r-200])(e.group)}).strength(.8)).force("collide",d3.forceCollide(function(e){return e.radius+2})).on("tick",function(){c.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y})});d.stop();var h=function a(i){var c;l=function(a){var i=d3.max(a,function(e){return+e.total});e=i;var o=d3.scaleSqrt().range([4,f]).domain([0,i]),s=a.map(function(e,t){return e={id:t,radius:o(+e.total),value:+e.total,name:e.program_name,country:e.country,category:e.category,year:e.year,group:+e.cluster_code,x:n/2,y:r/2}});return s.sort(function(e,t){return t.value-e.value}),t=o,s}(i),c=d3.keys(o),s.selectAll(".country").data(c).enter().append("g").attr("class","country").append("text").attr("text-anchor","middle").attr("x",function(e){return o[e].x}).attr("y",50).text(function(e){return"ElSalvador"===e?"El Salvador":e}),g(),p(),a.updateData(u.display,u.year)};function p(){d3.select("#bubble-toolbar").selectAll(".button").on("click",function(){d3.event.preventDefault(),d3.selectAll("#bubble-toolbar .button").classed("active",!1);var e=d3.select(this);e.classed("active",!0);var t=e.attr("id");u.display=t,h.updateData(u.display,u.year)}),u.display=d3.select("#bubble-toolbar").select(".active").attr("id")}function g(){var e=new Set;l.forEach(function(t){e.add(t.year)});var t=Array.from(e).sort(function(e,t){return t-e});d3.select("#year").on("change",function(){u.year=this.value,h.updateData(u.display,u.year)}).selectAll("option").data(t).enter().append("option").property("value",function(e){return e}).text(function(e){return e}),u.year=document.querySelector("#year").value}return h.updateData=function(n,u){if(n&&"all"!==n){var h=l.filter(function(e){return e.category===n&&+e.year==+u});d.force("y",d3.forceY(i.y).strength(.05))}else h=l.filter(function(e){return+e.year==+u}),d.force("y",d3.forceY(function(e){return d3.scaleLinear().domain([1,5]).range([250,r-250])(e.group)}).strength(.4));(c=s.selectAll(".bubble").data(h||l,function(e){return e.id})).exit().remove(),s.call(a);var p=!1;d3.select("body").on("click",function(){d3.selectAll(".selected, .d3-tip, .d3-tip *").filter(function(){return this===d3.event.target}).empty()&&p&&(d3.select(".selected").attr("stroke",function(e){return x(e.category)}),d3.select(".selected").attr("stroke-width",1),d3.select(".selected").classed("selected",!1),a.hide(d3.select(".selected")),p=!1)});var g=c.enter().append("circle").classed("bubble",!0).attr("r",0).attr("fill",function(e){return x(e.category)}).attr("fill-opacity",.2).attr("stroke",function(e){return x(e.category)}).attr("stroke-width",1).on("mouseover",function(e){p||(d3.select(d3.event.target).attr("stroke",d3.rgb(x(e.category)).darker()),d3.select(d3.event.target).attr("stroke-width",1.5),a.show(e,d3.event.target))}).on("mouseout",function(e){p||(d3.select(d3.event.target).attr("stroke",x(e.category)),d3.select(d3.event.target).attr("stroke-width",1),a.hide(e,d3.event.target))}).on("click",function(e){var t=d3.select(d3.event.target);t.attr("stroke",d3.rgb(x(e.category)).darker()),t.attr("stroke-width",1.5),t.classed("selected",!0),p=!0,a.show(e,d3.event.target)});(c=c.merge(g)).transition().duration(2e3).attr("r",function(e){return e.radius}),d.nodes(h||l),function(e){var t=d3.keys(o);function n(t){return e.filter(function(e){return e.country===t}).reduce(function(e,t){return e+t.value},0)}var r=s.selectAll(".total").data(t).text(function(e){return"$"+w(n(e).toString())});r.exit().remove(),r.enter().append("text").attr("class","total").attr("x",function(e){return o[e].x}).attr("y",75).attr("text-anchor","middle").text(function(e){return"$"+w(n(e).toString())}).merge(r)}(h||l),d.alpha(1).restart(),function(e){var n={},r={domain:[0,100],range:[0,80],values:[8,34,89],width:500,height:500,suffix:"",circleColor:"#888",textPadding:40,textColor:"#454545"},a=t;for(var i in n.render=function(){var t=e.append("g").attr("class","legend-wrap").attr("transform","translate(0,"+a(d3.max(r.values))+")");return t.append("g").attr("class","values-wrap").selectAll("circle").data(r.values).enter().append("circle").attr("class",function(e){return"values values-"+e}).attr("r",function(e){return a(e)}).attr("cx",r.width/2).attr("cy",function(e){return r.height/2-a(e)}).style("fill","none").style("stroke",r.circleColor).style("opacity",.5),t.append("g").attr("class","values-line-wrap").selectAll(".values-labels").data(r.values).enter().append("line").attr("x1",function(e){return r.width/2+a(e)}).attr("x2",r.width/2+a(r.domain[1])+20).attr("y1",function(e){return r.height/2-a(e)}).attr("y2",function(e){return r.height/2-a(e)}).style("stroke",r.textColor).style("stroke-dasharray","2,2"),t.append("g").attr("class","values-labels-wrap").selectAll(".values-labels").data(r.values).enter().append("text").attr("x",r.width/2+a(r.domain[1])+r.textPadding).attr("y",function(e){return r.height/2-a(e)+5}).attr("shape-rendering","crispEdges").style("text-anchor","start").style("fill",r.textColor).text(function(e){return d3.format("$.0s")(e)+r.suffix}),n},r)n[i]=o(i,n).bind(r);return n;function o(e,t){return function(n){return arguments.length?(this[e]=n,t):this[e]}}}(s).domain([0,e]).range([4,f]).values([3e6,3e7]).width(300).height(1200).suffix("").circleColor("#888").textPadding(25).textColor("#454545").render(),s.append("g").attr("class","legendOrdinal").attr("transform","translate(440,590)");var v=function(){var e=rn(),t="rect",n=15,r=15,a=10,i=2,o=[5],s=void 0,c=[],l="",u=!1,f="",d=$r.d3_defaultLocale,h=$r.d3_defaultFormatSpecifier,p=10,g="middle",v=$r.d3_defaultDelimiter,m=void 0,b="vertical",y=!1,w=void 0,x=void 0,_=Ce("cellover","cellout","cellclick");function C(C){var M=$r.d3_calcType(e,y,o,c,d.format(h),v);C.selectAll("g").data([e]).enter().append("g").attr("class",l+"legendCells"),s&&$r.d3_filterCells(M,s);var A=C.select("."+l+"legendCells").selectAll("."+l+"cell").data(M.data),T=A.enter().append("g").attr("class",l+"cell");T.append(t).attr("class",l+"swatch");var E=C.selectAll("g."+l+"cell "+t+"."+l+"swatch").data(M.data);$r.d3_addEvents(T,_),A.exit().transition().style("opacity",0).remove(),E.exit().transition().style("opacity",0).remove(),E=E.merge(E),$r.d3_drawShapes(t,E,r,n,a,w);var S=$r.d3_addText(C,T,M.labels,l,m);A=T.merge(A);var k=S.nodes().map(function(e){return e.getBBox()}),N=E.nodes().map(function(e){return e.getBBox()});u?E.attr("class",function(e){return l+"swatch "+M.feature(e)}):"line"==t?E.style("stroke",M.feature):E.style("fill",M.feature);var O,P=void 0,L=void 0,I="start"==g?0:"middle"==g?.5:1;"vertical"===b?(O=k.map(function(e,t){return Math.max(e.height,N[t].height)}),P=function(e,t){return"translate(0, "+(function(e,t){var n,r=0,a=e.length,i=-1;if(null==t)for(;++i<a;)(n=+e[i])&&(r+=n);else for(;++i<a;)(n=+t(e[i],i,e))&&(r+=n);return r}(O.slice(0,t))+t*i)+")"},L=function(e,t){return"translate( "+(N[t].width+N[t].x+p)+", "+(N[t].y+N[t].height/2+5)+")"}):"horizontal"===b&&(P=function(e,t){return"translate("+t*(N[t].width+i)+",0)"},L=function(e,t){return"translate("+(N[t].width*I+N[t].x)+",\n          "+(N[t].height+N[t].y+p+8)+")"}),$r.d3_placement(b,A,P,S,L,g),$r.d3_title(C,f,l,x),A.transition().style("opacity",1)}return C.scale=function(t){return arguments.length?(e=t,C):e},C.cells=function(e){return arguments.length?((e.length>1||e>=2)&&(o=e),C):o},C.cellFilter=function(e){return arguments.length?(s=e,C):s},C.shape=function(e,n){return arguments.length?(("rect"==e||"circle"==e||"line"==e||"path"==e&&"string"==typeof n)&&(t=e,w=n),C):t},C.shapeWidth=function(e){return arguments.length?(n=+e,C):n},C.shapeHeight=function(e){return arguments.length?(r=+e,C):r},C.shapeRadius=function(e){return arguments.length?(a=+e,C):a},C.shapePadding=function(e){return arguments.length?(i=+e,C):i},C.labels=function(e){return arguments.length?(c=e,C):c},C.labelAlign=function(e){return arguments.length?("start"!=e&&"end"!=e&&"middle"!=e||(g=e),C):g},C.locale=function(e){return arguments.length?(d=xe(e),C):d},C.labelFormat=function(e){return arguments.length?(h=pe(e),C):C.locale().format(h)},C.labelOffset=function(e){return arguments.length?(p=+e,C):p},C.labelDelimiter=function(e){return arguments.length?(v=e,C):v},C.labelWrap=function(e){return arguments.length?(m=e,C):m},C.useClass=function(e){return arguments.length?(!0!==e&&!1!==e||(u=e),C):u},C.orient=function(e){return arguments.length?("horizontal"!=(e=e.toLowerCase())&&"vertical"!=e||(b=e),C):b},C.ascending=function(e){return arguments.length?(y=!!e,C):y},C.classPrefix=function(e){return arguments.length?(l=e,C):l},C.title=function(e){return arguments.length?(f=e,C):f},C.titleWidth=function(e){return arguments.length?(x=e,C):x},C.textWrap=function(e){return arguments.length?(textWrap=e,C):textWrap},C.on=function(){var e=_.on.apply(_,arguments);return e===_?C:e},C}().shapePadding(160).shapeWidth(45).shapeHeight(20).labelOffset(15).orient("horizontal").scale(x);s.select(".legendOrdinal").call(v),s.selectAll(".legendOrdinal .swatch").style("fill-opacity",.2).style("stroke",function(e){return x(e)})},h}(),Xr=0;function Jr(e){return e>=48&&e<=57}function Qr(e,t){for(var n=(e+="").length,r=(t+="").length,a=0,i=0;a<n&&i<r;){var o=e.charCodeAt(a),s=t.charCodeAt(i);if(Jr(o)){if(!Jr(s))return o-s;for(var c=a,l=i;48===o&&++c<n;)o=e.charCodeAt(c);for(;48===s&&++l<r;)s=t.charCodeAt(l);for(var u=c,f=l;u<n&&Jr(e.charCodeAt(u));)++u;for(;f<r&&Jr(t.charCodeAt(f));)++f;var d=u-c-f+l;if(d)return d;for(;c<u;)if(d=e.charCodeAt(c++)-t.charCodeAt(l++))return d;a=u,i=f}else{if(o!==s)return o<Xr&&s<Xr&&-1!==Vr[o]&&-1!==Vr[s]?Vr[o]-Vr[s]:o-s;++a,++i}}return n-r}Qr.caseInsensitive=Qr.i=function(e,t){return Qr((""+e).toLowerCase(),(""+t).toLowerCase())},Object.defineProperties(Qr,{alphabet:{get:function(){return zr},set:function(e){Vr=[];var t=0;if(zr=e)for(;t<zr.length;t++)Vr[zr.charCodeAt(t)]=t;for(Xr=Vr.length,t=0;t<Xr;t++)void 0===Vr[t]&&(Vr[t]=-1)}}});var Gr=Qr,Kr=function(e,t,n,r){return(r=r||{}).test&&r.getElementsByClassName||!r.test&&document.getElementsByClassName?function(e,t,n){return n?e.getElementsByClassName(t)[0]:e.getElementsByClassName(t)}(e,t,n):r.test&&r.querySelector||!r.test&&document.querySelector?function(e,t,n){return t="."+t,n?e.querySelector(t):e.querySelectorAll(t)}(e,t,n):function(e,t,n){for(var r=[],a=e.getElementsByTagName("*"),i=a.length,o=new RegExp("(^|\\s)"+t+"(\\s|$)"),s=0,c=0;s<i;s++)if(o.test(a[s].className)){if(n)return a[s];r[c]=a[s],c++}return r}(e,t,n)},ea=function(e){for(var t,n=Array.prototype.slice.call(arguments,1),r=0;t=n[r];r++)if(t)for(var a in t)e[a]=t[a];return e},ta=[].indexOf,na=function(e,t){if(ta)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1},ra=function(e){if(void 0===e)return[];if(null===e)return[null];if(e===window)return[window];if("string"==typeof e)return[e];if(function(e){return"[object Array]"===Object.prototype.toString.call(e)}(e))return e;if("number"!=typeof e.length)return[e];if("function"==typeof e&&e instanceof Function)return[e];for(var t=[],n=0;n<e.length;n++)(Object.prototype.hasOwnProperty.call(e,n)||n in e)&&t.push(e[n]);return t.length?t:[]};var aa=window.addEventListener?"addEventListener":"attachEvent",ia=window.removeEventListener?"removeEventListener":"detachEvent",oa="addEventListener"!==aa?"on":"",sa={bind:function(e,t,n,r){e=ra(e);for(var a=0;a<e.length;a++)e[a][aa](oa+t,n,r||!1)},unbind:function(e,t,n,r){e=ra(e);for(var a=0;a<e.length;a++)e[a][ia](oa+t,n,r||!1)}},ca=function(e){return e=(e=null===(e=void 0===e?"":e)?"":e).toString()},la=/\s+/,ua=function(e){return new fa(e)};function fa(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}fa.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~na(t,e)||t.push(e),this.el.className=t.join(" "),this},fa.prototype.remove=function(e){if(this.list)return this.list.remove(e),this;var t=this.array(),n=na(t,e);return~n&&t.splice(n,1),this.el.className=t.join(" "),this},fa.prototype.toggle=function(e,t){return this.list?(void 0!==t?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(void 0!==t?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},fa.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(la);return""===e[0]&&e.shift(),e},fa.prototype.has=fa.prototype.contains=function(e){return this.list?this.list.contains(e):!!~na(this.array(),e)};var da=function(e,t){var n=e.getAttribute&&e.getAttribute(t)||null;if(!n)for(var r=e.attributes.length,a=0;a<r;a++)void 0!==t[a]&&t[a].nodeName===t&&(n=t[a].nodeValue);return n},ha=function(e){return function(t,n,r){var a=this;this._values={},this.found=!1,this.filtered=!1;this.values=function(t,n){if(void 0===t)return a._values;for(var r in t)a._values[r]=t[r];!0!==n&&e.templater.set(a,a.values())},this.show=function(){e.templater.show(a)},this.hide=function(){e.templater.hide(a)},this.matching=function(){return e.filtered&&e.searched&&a.found&&a.filtered||e.filtered&&!e.searched&&a.filtered||!e.filtered&&e.searched&&a.found||!e.filtered&&!e.searched},this.visible=function(){return!(!a.elm||a.elm.parentNode!=e.list)},function(t,n,r){if(void 0===n)r?a.values(t,r):a.values(t);else{a.elm=n;var i=e.templater.get(a,t);a.values(i)}}(t,n,r)}},pa=function(e){var t,n=this;this.clearSourceItem=function(t,n){for(var r=0,a=n.length;r<a;r++){var i;if(n[r].data)for(var o=0,s=n[r].data.length;o<s;o++)t.setAttribute("data-"+n[r].data[o],"");else n[r].attr&&n[r].name?(i=e.utils.getByClass(t,n[r].name,!0))&&i.setAttribute(n[r].attr,""):(i=e.utils.getByClass(t,n[r],!0))&&(i.innerHTML="");i=void 0}return t},this.getItemSource=function(t){if(void 0===t){for(var n=e.list.childNodes,r=0,a=n.length;r<a;r++)if(void 0===n[r].data)return n[r].cloneNode(!0)}else{if(/<tr[\s>]/g.exec(t)){var i=document.createElement("tbody");return i.innerHTML=t,i.firstChild}if(-1!==t.indexOf("<")){var o=document.createElement("div");return o.innerHTML=t,o.firstChild}var s=document.getElementById(e.item);if(s)return s}},this.get=function(t,r){n.create(t);for(var a={},i=0,o=r.length;i<o;i++){var s;if(r[i].data)for(var c=0,l=r[i].data.length;c<l;c++)a[r[i].data[c]]=e.utils.getAttribute(t.elm,"data-"+r[i].data[c]);else r[i].attr&&r[i].name?(s=e.utils.getByClass(t.elm,r[i].name,!0),a[r[i].name]=s?e.utils.getAttribute(s,r[i].attr):""):(s=e.utils.getByClass(t.elm,r[i],!0),a[r[i]]=s?s.innerHTML:"");s=void 0}return a},this.set=function(t,r){var a=function(n,r){var a,i=function(t){for(var n=0,r=e.valueNames.length;n<r;n++)if(e.valueNames[n].data){for(var a=e.valueNames[n].data,i=0,o=a.length;i<o;i++)if(a[i]===t)return{data:t}}else{if(e.valueNames[n].attr&&e.valueNames[n].name&&e.valueNames[n].name==t)return e.valueNames[n];if(e.valueNames[n]===t)return t}}(n);i&&(i.data?t.elm.setAttribute("data-"+i.data,r):i.attr&&i.name?(a=e.utils.getByClass(t.elm,i.name,!0))&&a.setAttribute(i.attr,r):(a=e.utils.getByClass(t.elm,i,!0))&&(a.innerHTML=r),a=void 0)};if(!n.create(t))for(var i in r)r.hasOwnProperty(i)&&a(i,r[i])},this.create=function(e){if(void 0!==e.elm)return!1;if(void 0===t)throw new Error("The list need to have at list one item on init otherwise you'll have to add a template.");var r=t.cloneNode(!0);return r.removeAttribute("id"),e.elm=r,n.set(e,e.values()),!0},this.remove=function(t){t.elm.parentNode===e.list&&e.list.removeChild(t.elm)},this.show=function(t){n.create(t),e.list.appendChild(t.elm)},this.hide=function(t){void 0!==t.elm&&t.elm.parentNode===e.list&&e.list.removeChild(t.elm)},this.clear=function(){if(e.list.hasChildNodes())for(;e.list.childNodes.length>=1;)e.list.removeChild(e.list.firstChild)},(t=n.getItemSource(e.item))&&(t=n.clearSourceItem(t,e.valueNames))},ga=function(e,t){t=ea({location:0,distance:100,threshold:.4,multiSearch:!0,searchClass:"fuzzy-search"},t=t||{});var n={search:function(r,a){for(var i=t.multiSearch?r.replace(/ +$/,"").split(/ +/):[r],o=0,s=e.items.length;o<s;o++)n.item(e.items[o],a,i)},item:function(e,t,r){for(var a=!0,i=0;i<r.length;i++){for(var o=!1,s=0,c=t.length;s<c;s++)n.values(e.values(),t[s],r[i])&&(o=!0);o||(a=!1)}e.found=a},values:function(e,n,r){if(e.hasOwnProperty(n)&&function(e,t,n){var r=n.location||0,a=n.distance||100,i=n.threshold||.4;if(t===e)return!0;if(t.length>32)return!1;var o=r,s=function(){var e,n={};for(e=0;e<t.length;e++)n[t.charAt(e)]=0;for(e=0;e<t.length;e++)n[t.charAt(e)]|=1<<t.length-e-1;return n}();function c(e,n){var r=e/t.length,i=Math.abs(o-n);return a?r+i/a:i?1:r}var l=i,u=e.indexOf(t,o);-1!=u&&(l=Math.min(c(0,u),l),-1!=(u=e.lastIndexOf(t,o+t.length))&&(l=Math.min(c(0,u),l)));var f,d,h=1<<t.length-1;u=-1;for(var p,g=t.length+e.length,v=0;v<t.length;v++){for(f=0,d=g;f<d;)c(v,o+d)<=l?f=d:g=d,d=Math.floor((g-f)/2+f);g=d;var m=Math.max(1,o-d+1),b=Math.min(o+d,e.length)+t.length,y=Array(b+2);y[b+1]=(1<<v)-1;for(var w=b;w>=m;w--){var x=s[e.charAt(w-1)];if(y[w]=0===v?(y[w+1]<<1|1)&x:(y[w+1]<<1|1)&x|(p[w+1]|p[w])<<1|1|p[w+1],y[w]&h){var _=c(v,w-1);if(_<=l){if(l=_,!((u=w-1)>o))break;m=Math.max(1,2*o-u)}}}if(c(v+1,o)>l)break;p=y}return!(u<0)}(ca(e[n]).toLowerCase(),r,t))return!0;return!1}};return sa.bind(Kr(e.listContainer,t.searchClass),"keyup",function(t){var r=t.target||t.srcElement;e.search(r.value,n.search)}),function(t,r){e.search(t,r,n.search)}},va=function(e,t,n){var r,a,i,o,s,c=this,l=ha(c),u=function(e){var t=function(n,r,a){var i=n.splice(0,50);a=(a=a||[]).concat(e.add(i)),n.length>0?setTimeout(function(){t(n,r,a)},1):(e.update(),r(a))};return t}(c),f=(a=c,i=function(e,t){var n,r=a.matchingItems.length,i=a.i,c=a.page,l=Math.ceil(r/c),u=Math.ceil(i/c),f=t.innerWindow||2,d=t.left||t.outerWindow||0,h=t.right||t.outerWindow||0;h=l-h,e.clear();for(var p=1;p<=l;p++){var g=u===p?"active":"";o.number(p,d,h,u,f)?(n=e.add({page:p,dotted:!1})[0],g&&ua(n.elm).add(g),s(n.elm,p,c)):o.dotted(e,p,d,h,u,f,e.size())&&(n=e.add({page:"...",dotted:!0})[0],ua(n.elm).add("disabled"))}},o={number:function(e,t,n,r,a){return this.left(e,t)||this.right(e,n)||this.innerWindow(e,r,a)},left:function(e,t){return e<=t},right:function(e,t){return e>t},innerWindow:function(e,t,n){return e>=t-n&&e<=t+n},dotted:function(e,t,n,r,a,i,o){return this.dottedLeft(e,t,n,r,a,i)||this.dottedRight(e,t,n,r,a,i,o)},dottedLeft:function(e,t,n,r,a,i){return t==n+1&&!this.innerWindow(t,a,i)&&!this.right(t,r)},dottedRight:function(e,t,n,r,a,i,o){return!e.items[o-1].values().dotted&&t==r&&!this.innerWindow(t,a,i)&&!this.right(t,r)}},s=function(e,t,n){sa.bind(e,"click",function(){a.show((t-1)*n+1,n)})},function(e){var t=new va(a.listContainer.id,{listClass:e.paginationClass||"pagination",item:"<li><a class='page' href='javascript:function Z(){Z=\"\"}Z()'></a></li>",valueNames:["page","dotted"],searchClass:"pagination-search-that-is-not-supposed-to-exist",sortClass:"pagination-sort-that-is-not-supposed-to-exist"});a.on("updated",function(){i(t,e)}),i(t,e)});r={start:function(){(c.listClass="list",c.searchClass="search",c.sortClass="sort",c.page=1e4,c.i=1,c.items=[],c.visibleItems=[],c.matchingItems=[],c.searched=!1,c.filtered=!1,c.searchColumns=void 0,c.handlers={updated:[]},c.valueNames=[],c.utils={getByClass:Kr,extend:ea,indexOf:na,events:sa,toString:ca,naturalSort:Gr,classes:ua,getAttribute:da,toArray:ra},c.utils.extend(c,t),c.listContainer="string"==typeof e?document.getElementById(e):e,c.listContainer)&&(c.list=Kr(c.listContainer,c.listClass,!0),c.parse=function(e){var t=ha(e),n=function(n,r){for(var a=0,i=n.length;a<i;a++)e.items.push(new t(r,n[a]))},r=function(t,a){var i=t.splice(0,50);n(i,a),t.length>0?setTimeout(function(){r(t,a)},1):(e.update(),e.trigger("parseComplete"))};return e.handlers.parseComplete=e.handlers.parseComplete||[],function(){var t=function(e){for(var t=e.childNodes,n=[],r=0,a=t.length;r<a;r++)void 0===t[r].data&&n.push(t[r]);return n}(e.list),a=e.valueNames;e.indexAsync?r(t,a):n(t,a)}}(c),c.templater=new pa(c),c.search=function(e){var t,n,r,a,i={resetList:function(){e.i=1,e.templater.clear(),a=void 0},setOptions:function(e){2==e.length&&e[1]instanceof Array?n=e[1]:2==e.length&&"function"==typeof e[1]?(n=void 0,a=e[1]):3==e.length?(n=e[1],a=e[2]):n=void 0},setColumns:function(){0!==e.items.length&&void 0===n&&(n=void 0===e.searchColumns?i.toArray(e.items[0].values()):e.searchColumns)},setSearchString:function(t){t=(t=e.utils.toString(t).toLowerCase()).replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&"),r=t},toArray:function(e){var t=[];for(var n in e)t.push(n);return t}},o={list:function(){for(var t=0,n=e.items.length;t<n;t++)o.item(e.items[t])},item:function(e){e.found=!1;for(var t=0,r=n.length;t<r;t++)if(o.values(e.values(),n[t]))return void(e.found=!0)},values:function(n,a){return!!(n.hasOwnProperty(a)&&(t=e.utils.toString(n[a]).toLowerCase(),""!==r&&t.search(r)>-1))},reset:function(){e.reset.search(),e.searched=!1}},s=function(t){return e.trigger("searchStart"),i.resetList(),i.setSearchString(t),i.setOptions(arguments),i.setColumns(),""===r?o.reset():(e.searched=!0,a?a(r,n):o.list()),e.update(),e.trigger("searchComplete"),e.visibleItems};return e.handlers.searchStart=e.handlers.searchStart||[],e.handlers.searchComplete=e.handlers.searchComplete||[],e.utils.events.bind(e.utils.getByClass(e.listContainer,e.searchClass),"keyup",function(t){var n=t.target||t.srcElement;""===n.value&&!e.searched||s(n.value)}),e.utils.events.bind(e.utils.getByClass(e.listContainer,e.searchClass),"input",function(e){""===(e.target||e.srcElement).value&&s("")}),s}(c),c.filter=function(e){return e.handlers.filterStart=e.handlers.filterStart||[],e.handlers.filterComplete=e.handlers.filterComplete||[],function(t){if(e.trigger("filterStart"),e.i=1,e.reset.filter(),void 0===t)e.filtered=!1;else{e.filtered=!0;for(var n=e.items,r=0,a=n.length;r<a;r++){var i=n[r];t(i)?i.filtered=!0:i.filtered=!1}}return e.update(),e.trigger("filterComplete"),e.visibleItems}}(c),c.sort=function(e){var t={els:void 0,clear:function(){for(var n=0,r=t.els.length;n<r;n++)e.utils.classes(t.els[n]).remove("asc"),e.utils.classes(t.els[n]).remove("desc")},getOrder:function(t){var n=e.utils.getAttribute(t,"data-order");return"asc"==n||"desc"==n?n:e.utils.classes(t).has("desc")?"asc":e.utils.classes(t).has("asc")?"desc":"asc"},getInSensitive:function(t,n){var r=e.utils.getAttribute(t,"data-insensitive");n.insensitive="false"!==r},setOrder:function(n){for(var r=0,a=t.els.length;r<a;r++){var i=t.els[r];if(e.utils.getAttribute(i,"data-sort")===n.valueName){var o=e.utils.getAttribute(i,"data-order");"asc"==o||"desc"==o?o==n.order&&e.utils.classes(i).add(n.order):e.utils.classes(i).add(n.order)}}}},n=function(){e.trigger("sortStart");var n={},r=arguments[0].currentTarget||arguments[0].srcElement||void 0;r?(n.valueName=e.utils.getAttribute(r,"data-sort"),t.getInSensitive(r,n),n.order=t.getOrder(r)):((n=arguments[1]||n).valueName=arguments[0],n.order=n.order||"asc",n.insensitive=void 0===n.insensitive||n.insensitive),t.clear(),t.setOrder(n);var a,i=n.sortFunction||e.sortFunction||null,o="desc"===n.order?-1:1;a=i?function(e,t){return i(e,t,n)*o}:function(t,r){var a=e.utils.naturalSort;return a.alphabet=e.alphabet||n.alphabet||void 0,!a.alphabet&&n.insensitive&&(a=e.utils.naturalSort.caseInsensitive),a(t.values()[n.valueName],r.values()[n.valueName])*o},e.items.sort(a),e.update(),e.trigger("sortComplete")};return e.handlers.sortStart=e.handlers.sortStart||[],e.handlers.sortComplete=e.handlers.sortComplete||[],t.els=e.utils.getByClass(e.listContainer,e.sortClass),e.utils.events.bind(t.els,"click",n),e.on("searchStart",t.clear),e.on("filterStart",t.clear),n}(c),c.fuzzySearch=ga(c,t.fuzzySearch),this.handlers(),this.items(),this.pagination(),c.update())},handlers:function(){for(var e in c.handlers)c[e]&&c.on(e,c[e])},items:function(){c.parse(c.list),void 0!==n&&c.add(n)},pagination:function(){if(void 0!==t.pagination){!0===t.pagination&&(t.pagination=[{}]),void 0===t.pagination[0]&&(t.pagination=[t.pagination]);for(var e=0,n=t.pagination.length;e<n;e++)f(t.pagination[e])}}},this.reIndex=function(){c.items=[],c.visibleItems=[],c.matchingItems=[],c.searched=!1,c.filtered=!1,c.parse(c.list)},this.toJSON=function(){for(var e=[],t=0,n=c.items.length;t<n;t++)e.push(c.items[t].values());return e},this.add=function(e,t){if(0!==e.length){if(!t){var n=[],r=!1;void 0===e[0]&&(e=[e]);for(var a=0,i=e.length;a<i;a++){var o;r=c.items.length>c.page,o=new l(e[a],void 0,r),c.items.push(o),n.push(o)}return c.update(),n}u(e,t)}},this.show=function(e,t){return this.i=e,this.page=t,c.update(),c},this.remove=function(e,t,n){for(var r=0,a=0,i=c.items.length;a<i;a++)c.items[a].values()[e]==t&&(c.templater.remove(c.items[a],n),c.items.splice(a,1),i--,a--,r++);return c.update(),r},this.get=function(e,t){for(var n=[],r=0,a=c.items.length;r<a;r++){var i=c.items[r];i.values()[e]==t&&n.push(i)}return n},this.size=function(){return c.items.length},this.clear=function(){return c.templater.clear(),c.items=[],c},this.on=function(e,t){return c.handlers[e].push(t),c},this.off=function(e,t){var n=c.handlers[e],r=na(n,t);return r>-1&&n.splice(r,1),c},this.trigger=function(e){for(var t=c.handlers[e].length;t--;)c.handlers[e][t](c);return c},this.reset={filter:function(){for(var e=c.items,t=e.length;t--;)e[t].filtered=!1;return c},search:function(){for(var e=c.items,t=e.length;t--;)e[t].found=!1;return c}},this.update=function(){var e=c.items,t=e.length;c.visibleItems=[],c.matchingItems=[],c.templater.clear();for(var n=0;n<t;n++)e[n].matching()&&c.matchingItems.length+1>=c.i&&c.visibleItems.length<c.page?(e[n].show(),c.visibleItems.push(e[n]),c.matchingItems.push(e[n])):e[n].matching()?(c.matchingItems.push(e[n]),e[n].hide()):e[n].hide();return c.trigger("updated"),c},r.start()};d3.json("https://s3.amazonaws.com/wola-cam//19dwn5dI7bjj0hS4SNY-uE-lfPq0NrbRMZh5p2ofU4Zo",function(e,t){e&&console.log(e),Zr(t),M(t),function(e){d3.select("#table-body").selectAll(".temp-wrapper").data(e).enter().append("tbody").classed("temp-wrapper",!0).html(function(e){var t;return t="ElSalvador"===e.country?"El Salvador":e.country,'\n    <tr class="bx--parent-row-v2" data-parent-row>\n      <td class="bx--table-expand-v2" data-event="expand">\n        <button class="bx--table-expand-v2__button">\n          <svg class="bx--table-expand-v2__svg" width="8" height="12" viewBox="0 0 8 12" fill-rule="evenodd">\n            <path d="M0 10.6L4.7 6 0 1.4 1.4 0l6.1 6-6.1 6z"></path>\n          </svg>\n        </button>\n      </td>\n      <td class="program">'+e.program_name+'</td>\n      <td class="total" data-total="'+e.total+'">$'+w(e.total)+'</td>\n      <td class="year">'+e.year+'</td>\n      <td class="category">'+e.category+'</td>\n      <td class="country">'+t+'</td>\n      <td class="account">'+(e.account?e.account:"")+'</td>\n      <td class="source">'+(e.source?e.source:"")+'</td>\n    </tr>\n    <tr class="bx--expandable-row-v2 bx--expandable-row--hidden-v2" data-child-row>\n      <td colspan="8">\n        <h4>\n          <strong>Description</strong>\n        </h4>\n        <p>'+e.description+"</p>\n      </td>\n    </tr>\n    "}),document.querySelectorAll("tbody.temp-wrapper").forEach(function(e){for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);e.parentNode.removeChild(e)});var t=document.querySelector("[data-table-v2]"),n=d.create(t),r=new va("sort",{valueNames:["program",{name:"total",attr:"data-total"},"year","category","country","account","source"],page:10});n.refreshRows();var a=document.querySelector("[data-total-items]"),i=document.querySelector("[data-items-per-page]"),o=document.querySelector("[data-page-forward]"),s=document.querySelector("[data-page-backward]"),c=document.querySelector("[data-page-number-input]"),l=document.querySelector("[data-displayed-page-number]"),u=document.querySelector("[data-total-pages]");function f(){var e=Math.ceil(r.matchingItems.length/r.page),t=document.createRange();t.selectNodeContents(c),t.deleteContents();for(var n=1;n<=e;n++){var a=document.createElement("option");a.classList.add("bx--select-option"),a.setAttribute("value",n),a.innerHTML=n,c.appendChild(a)}c.selectedIndex=(r.i-1)/r.page}function h(){var e=Math.ceil(r.matchingItems.length/r.page),t=c.value;u.innerHTML=e,l.innerHTML=t}function p(){var e=r.page,t=document.querySelector("[data-displayed-item-range]"),n=+r.i+ +e-1;n>r.matchingItems.length&&(n=r.matchingItems.length),t.innerHTML=r.i+"-"+n}f(),h(),o.addEventListener("click",function(e){c.value!=c.length&&(r.i=c.value*r.page+1,c.selectedIndex++,r.show(r.i,r.page))}),s.addEventListener("click",function(e){1!=c.value&&(r.i=r.i-r.page,c.selectedIndex--,r.show(r.i,r.page))}),c.addEventListener("change",function(e){r.i=(e.target.value-1)*r.page+1,r.show(r.i,r.page)}),a.innerHTML=r.matchingItems.length,p(),a.innerHTML,i.value,r.on("updated",function(e){a.innerHTML=r.matchingItems.length,p(),f(),h(),n.refreshRows()}),i.addEventListener("change",function(e){var t=e.target.value;r.page=t,p(),r.update()})}(t),new C.Child})}();
//# sourceMappingURL=main.min.js.map
